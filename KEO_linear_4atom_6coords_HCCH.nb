(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    245311,       6214]
NotebookOptionsPosition[    242075,       6097]
NotebookOutlinePosition[    242483,       6113]
CellTagsIndexPosition[    242440,       6110]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
KEO for HCCH: linear 4 atoms, 6 internal coordinates\
\>", "Title",
 CellChangeTimes->{
  3.730456728963736*^9, {3.73045816473403*^9, 3.730458186022729*^9}}],

Cell[CellGroupData[{

Cell["Initialise variables", "Section",
 CellChangeTimes->{{3.730456758466885*^9, 3.730456761873692*^9}, {
  3.730456908597766*^9, 3.7304569087333193`*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.643698497669169*^9, 3.643698627680748*^9}, {
   3.643698665811211*^9, 3.643698956729582*^9}, {3.643699144907583*^9, 
   3.643699224690542*^9}, {3.6436992877012377`*^9, 3.6436993782931843`*^9}, {
   3.643699449311922*^9, 3.643699621174951*^9}, {3.643699683613538*^9, 
   3.643699686085781*^9}, {3.643699742910721*^9, 3.643699868573607*^9}, {
   3.6436999489506283`*^9, 3.6437000682787113`*^9}, {3.643700124534732*^9, 
   3.643700210097245*^9}, {3.643700246559291*^9, 3.6437003476911697`*^9}, {
   3.643700434599622*^9, 3.6437004814126*^9}, {3.643700553505638*^9, 
   3.643700638740032*^9}, {3.6437006742289333`*^9, 3.643700816186289*^9}, {
   3.6437008564735603`*^9, 3.643700885401257*^9}, {3.6437009759526873`*^9, 
   3.643700991333433*^9}, {3.6437010251723223`*^9, 3.6437010377179623`*^9}, {
   3.6437011551122637`*^9, 3.6437012459817266`*^9}, {3.643701370301364*^9, 
   3.643701407220009*^9}, {3.643701518580022*^9, 3.643701522526347*^9}, {
   3.643702517090665*^9, 3.643702587463787*^9}, {3.643702631300232*^9, 
   3.6437026370543747`*^9}, {3.643702750362689*^9, 3.643702760800075*^9}, {
   3.643702821898019*^9, 3.643702828253956*^9}, {3.6437029059489*^9, 
   3.6437029079020653`*^9}, {3.6437029431735983`*^9, 3.643702980272038*^9}, {
   3.643703102137313*^9, 3.643703112071394*^9}, {3.6437031894702063`*^9, 
   3.643703215124378*^9}, {3.643703316976391*^9, 3.6437033224141693`*^9}, {
   3.643703374413019*^9, 3.643703427211299*^9}, {3.643703490217187*^9, 
   3.643703564613058*^9}, {3.643703691281543*^9, 3.643703743485059*^9}, {
   3.643703888168742*^9, 3.643703896602737*^9}, {3.6437048267282352`*^9, 
   3.6437048975394363`*^9}, {3.6437057444605293`*^9, 3.643705752190124*^9}, {
   3.643705954972937*^9, 3.643705961153522*^9}, {3.643706002097444*^9, 
   3.6437060109569902`*^9}, {3.643960095615589*^9, 3.643960140330454*^9}, {
   3.643960172355269*^9, 3.643960178084527*^9}, {3.6439603167672043`*^9, 
   3.643960393589735*^9}, {3.643960529153203*^9, 3.643960539005945*^9}, {
   3.6439605742932463`*^9, 3.64396058079244*^9}, {3.64396061788204*^9, 
   3.643960624934157*^9}, {3.643960659673005*^9, 3.6439608155512247`*^9}, {
   3.64396085375667*^9, 3.6439608555258913`*^9}, {3.6439608954629183`*^9, 
   3.64396092812294*^9}, {3.643966136471962*^9, 3.643966143649735*^9}, {
   3.643966178769548*^9, 3.643966372986576*^9}, {3.643966403377626*^9, 
   3.6439666027902184`*^9}, 3.6439666502693167`*^9, {3.6439666996029463`*^9, 
   3.643966708197776*^9}, {3.6439667513430567`*^9, 3.64396680012965*^9}, {
   3.643966834596304*^9, 3.643966837954664*^9}, {3.6439669119436817`*^9, 
   3.643966936915223*^9}, {3.643966972764987*^9, 3.64396697303123*^9}, {
   3.6439671050066013`*^9, 3.643967109691283*^9}, {3.643967832402573*^9, 
   3.6439678378124123`*^9}, {3.643967877320889*^9, 3.643967902883573*^9}, {
   3.643968914149847*^9, 3.643968917104064*^9}, {3.643970410857933*^9, 
   3.643970414988474*^9}, {3.643972531846291*^9, 3.643972568442237*^9}, 
   3.643972599611711*^9, {3.6439731986267138`*^9, 3.6439732406970778`*^9}, {
   3.643973512303945*^9, 3.643973515707995*^9}, 3.644318205529643*^9, {
   3.644318252767625*^9, 3.6443182857972507`*^9}, {3.644318361822673*^9, 
   3.6443183742891893`*^9}, {3.644318494097309*^9, 3.644318497088481*^9}, {
   3.645947962802093*^9, 3.645947991364691*^9}, {3.6463177774999113`*^9, 
   3.64631778482887*^9}, {3.646323014451133*^9, 3.646323045488997*^9}, {
   3.6463231021323*^9, 3.6463231364709578`*^9}, {3.646323571475122*^9, 
   3.646323578035534*^9}, {3.647163278985786*^9, 3.6471632873222637`*^9}, {
   3.647195486979968*^9, 3.64719553524255*^9}, {3.6471957507111*^9, 
   3.64719583572884*^9}, {3.647195877044752*^9, 3.647195969940988*^9}, {
   3.647196032981365*^9, 3.647196098038104*^9}, {3.647196241187873*^9, 
   3.647196514370511*^9}, 3.647196714421215*^9, {3.6471972815225277`*^9, 
   3.647197313787243*^9}, {3.64719762209519*^9, 3.647197652670203*^9}, {
   3.6471981181329803`*^9, 3.647198127063168*^9}, {3.647198204297744*^9, 
   3.647198234123966*^9}, {3.647198299080751*^9, 3.647198356199029*^9}, {
   3.647198399676033*^9, 3.647198415724359*^9}, {3.647198842609527*^9, 
   3.64719886721236*^9}, {3.647236130505217*^9, 3.647236130849965*^9}, {
   3.647242095016677*^9, 3.647242119614949*^9}, {3.647242162816025*^9, 
   3.647242186745997*^9}, {3.651495587713932*^9, 3.651495613513898*^9}, {
   3.6514956681837063`*^9, 3.651495773369631*^9}, {3.651495805140808*^9, 
   3.651495899897871*^9}, {3.651496044087434*^9, 3.651496065745228*^9}, {
   3.6537194084830914`*^9, 3.653719473288549*^9}, 3.653720470026661*^9, {
   3.653720823862599*^9, 3.653720832721386*^9}, {3.653720873185301*^9, 
   3.653720875551272*^9}, 3.68778613293778*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Variables", " ", "to", " ", "set"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"natoms", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ncoords", "=", "6"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Max", " ", "order", " ", "for", " ", "the", " ", "expansion", " ", "in", 
     " ", "the", " ", "last", " ", "section"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxorderGMAT", "=", "6"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"maxorderPSEUDO", "=", "6"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Number", " ", "of", " ", "rotations", " ", "is", " ", "3", "N"}], "-", 
     RowBox[{
     "6", " ", "where", " ", "N", " ", "is", " ", "internal", " ", 
      "coordinates", " ", "ncoords"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nrot", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mass", "=", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"], ",", 
       SubscriptBox["m", "3"], ",", 
       SubscriptBox["m", "4"]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Can", " ", "amend", " ", "below", " ", "for", " ", "different", " ", 
     "coordinate", " ", "sets"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coords", "=", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["r", "0"], ",", 
       SubscriptBox["r", "1"], ",", 
       SubscriptBox["r", "2"], ",", 
       SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], ",", 
       SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], ",", "\[Tau]"}], "}"}]}],
     ";"}]}]}]], "Input",
 CellChangeTimes->{{3.643698497669169*^9, 3.643698627680748*^9}, {
   3.643698665811211*^9, 3.643698956729582*^9}, {3.643699144907583*^9, 
   3.643699224690542*^9}, {3.6436992877012377`*^9, 3.6436993782931843`*^9}, {
   3.643699449311922*^9, 3.643699621174951*^9}, {3.643699683613538*^9, 
   3.643699686085781*^9}, {3.643699742910721*^9, 3.643699868573607*^9}, {
   3.6436999489506283`*^9, 3.6437000682787113`*^9}, {3.643700124534732*^9, 
   3.643700210097245*^9}, {3.643700246559291*^9, 3.6437003476911697`*^9}, {
   3.643700434599622*^9, 3.6437004814126*^9}, {3.643700553505638*^9, 
   3.643700638740032*^9}, {3.6437006742289333`*^9, 3.643700816186289*^9}, {
   3.6437008564735603`*^9, 3.643700885401257*^9}, {3.6437009759526873`*^9, 
   3.643700991333433*^9}, {3.6437010251723223`*^9, 3.6437010377179623`*^9}, {
   3.6437011551122637`*^9, 3.6437012459817266`*^9}, {3.643701370301364*^9, 
   3.643701407220009*^9}, {3.643701518580022*^9, 3.643701522526347*^9}, {
   3.643702517090665*^9, 3.643702587463787*^9}, {3.643702631300232*^9, 
   3.6437026370543747`*^9}, {3.643702750362689*^9, 3.643702760800075*^9}, {
   3.643702821898019*^9, 3.643702828253956*^9}, {3.6437029059489*^9, 
   3.6437029079020653`*^9}, {3.6437029431735983`*^9, 3.643702980272038*^9}, {
   3.643703102137313*^9, 3.643703112071394*^9}, {3.6437031894702063`*^9, 
   3.643703215124378*^9}, {3.643703316976391*^9, 3.6437033224141693`*^9}, {
   3.643703374413019*^9, 3.643703427211299*^9}, {3.643703490217187*^9, 
   3.643703564613058*^9}, {3.643703691281543*^9, 3.643703743485059*^9}, {
   3.643703888168742*^9, 3.643703896602737*^9}, {3.6437048267282352`*^9, 
   3.6437048975394363`*^9}, {3.6437057444605293`*^9, 3.643705752190124*^9}, {
   3.643705954972937*^9, 3.643705961153522*^9}, {3.643706002097444*^9, 
   3.6437060109569902`*^9}, {3.643960095615589*^9, 3.643960140330454*^9}, {
   3.643960172355269*^9, 3.643960178084527*^9}, {3.6439603167672043`*^9, 
   3.643960393589735*^9}, {3.643960529153203*^9, 3.643960539005945*^9}, {
   3.6439605742932463`*^9, 3.64396058079244*^9}, {3.64396061788204*^9, 
   3.643960624934157*^9}, {3.643960659673005*^9, 3.6439608155512247`*^9}, {
   3.64396085375667*^9, 3.6439608555258913`*^9}, {3.6439608954629183`*^9, 
   3.64396092812294*^9}, {3.643966136471962*^9, 3.643966143649735*^9}, {
   3.643966178769548*^9, 3.643966372986576*^9}, {3.643966403377626*^9, 
   3.6439666027902184`*^9}, 3.6439666502693167`*^9, {3.6439666996029463`*^9, 
   3.643966708197776*^9}, {3.6439667513430567`*^9, 3.64396680012965*^9}, {
   3.643966834596304*^9, 3.643966837954664*^9}, {3.6439669119436817`*^9, 
   3.643966936915223*^9}, {3.643966972764987*^9, 3.64396697303123*^9}, {
   3.6439671050066013`*^9, 3.643967109691283*^9}, {3.643967832402573*^9, 
   3.6439678378124123`*^9}, {3.643967877320889*^9, 3.643967902883573*^9}, {
   3.643968914149847*^9, 3.643968917104064*^9}, {3.643970410857933*^9, 
   3.643970414988474*^9}, {3.643972531846291*^9, 3.643972568442237*^9}, 
   3.643972599611711*^9, {3.6439731986267138`*^9, 3.6439732406970778`*^9}, {
   3.643973512303945*^9, 3.643973515707995*^9}, 3.644318205529643*^9, {
   3.644318252767625*^9, 3.6443182857972507`*^9}, {3.644318361822673*^9, 
   3.6443183742891893`*^9}, {3.644318494097309*^9, 3.644318497088481*^9}, {
   3.645947962802093*^9, 3.645947991364691*^9}, {3.6463177774999113`*^9, 
   3.64631778482887*^9}, {3.646323014451133*^9, 3.646323045488997*^9}, {
   3.6463231021323*^9, 3.6463231364709578`*^9}, {3.646323571475122*^9, 
   3.646323578035534*^9}, {3.647163278985786*^9, 3.6471632873222637`*^9}, {
   3.647195486979968*^9, 3.64719553524255*^9}, {3.6471957507111*^9, 
   3.64719583572884*^9}, {3.647195877044752*^9, 3.647195969940988*^9}, {
   3.647196032981365*^9, 3.647196098038104*^9}, {3.647196241187873*^9, 
   3.647196514370511*^9}, 3.647196714421215*^9, {3.6471972815225277`*^9, 
   3.647197313787243*^9}, {3.64719762209519*^9, 3.647197652670203*^9}, {
   3.6471981181329803`*^9, 3.647198127063168*^9}, {3.647198204297744*^9, 
   3.647198234123966*^9}, {3.647198299080751*^9, 3.647198356199029*^9}, {
   3.647198399676033*^9, 3.647198415724359*^9}, {3.647198842609527*^9, 
   3.64719886721236*^9}, {3.647236130505217*^9, 3.647236130849965*^9}, {
   3.647242095016677*^9, 3.647242119614949*^9}, {3.647242162816025*^9, 
   3.647242186745997*^9}, {3.651495587713932*^9, 3.651495613513898*^9}, {
   3.6514956681837063`*^9, 3.651495773369631*^9}, {3.651495805140808*^9, 
   3.651495899897871*^9}, {3.651496044087434*^9, 3.651496065745228*^9}, {
   3.6537194084830914`*^9, 3.653719473288549*^9}, 3.653720470026661*^9, {
   3.653720823862599*^9, 3.653720832721386*^9}, {3.653720873185301*^9, 
   3.653720875551272*^9}, {3.68778613293778*^9, 3.687786135059392*^9}, {
   3.7304567685096292`*^9, 3.730456837665224*^9}, 3.7304568841075373`*^9}],

Cell[CellGroupData[{

Cell["\<\
Define and print Cartesian coordinates\
\>", "Subsection",
 CellChangeTimes->{{3.730456904046731*^9, 3.730456916254121*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Cartesian", " ", "coords", " ", "of", " ", "atoms"}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[Alpha]", "1"], "=", 
     RowBox[{"Pi", "-", 
      SubscriptBox["\[CapitalDelta]\[Alpha]", "1"]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[Alpha]", "2"], "=", 
     RowBox[{"Pi", "-", 
      SubscriptBox["\[CapitalDelta]\[Alpha]", "2"]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cart", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         SubscriptBox["r", "0"]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["r", "1"], "*", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Alpha]", "1"], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"-", "\[Tau]"}], "]"}]}], ",", 
         RowBox[{
          SubscriptBox["r", "1"], "*", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Alpha]", "1"], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"-", "\[Tau]"}], "]"}]}], ",", 
         RowBox[{
          SubscriptBox["r", "1"], "*", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Alpha]", "1"], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["r", "2"], "*", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Alpha]", "2"], "]"}], "*", 
          RowBox[{"Cos", "[", "\[Tau]", "]"}]}], ",", 
         RowBox[{
          SubscriptBox["r", "2"], "*", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Alpha]", "2"], "]"}], "*", 
          RowBox[{"Sin", "[", "\[Tau]", "]"}]}], ",", 
         RowBox[{
          SubscriptBox["r", "0"], "-", 
          RowBox[{
           SubscriptBox["r", "2"], "*", 
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Alpha]", "2"], "]"}]}]}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"cart", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.643698497669169*^9, 3.643698627680748*^9}, {
   3.643698665811211*^9, 3.643698956729582*^9}, {3.643699144907583*^9, 
   3.643699224690542*^9}, {3.6436992877012377`*^9, 3.6436993782931843`*^9}, {
   3.643699449311922*^9, 3.643699621174951*^9}, {3.643699683613538*^9, 
   3.643699686085781*^9}, {3.643699742910721*^9, 3.643699868573607*^9}, {
   3.6436999489506283`*^9, 3.6437000682787113`*^9}, {3.643700124534732*^9, 
   3.643700210097245*^9}, {3.643700246559291*^9, 3.6437003476911697`*^9}, {
   3.643700434599622*^9, 3.6437004814126*^9}, {3.643700553505638*^9, 
   3.643700638740032*^9}, {3.6437006742289333`*^9, 3.643700816186289*^9}, {
   3.6437008564735603`*^9, 3.643700885401257*^9}, {3.6437009759526873`*^9, 
   3.643700991333433*^9}, {3.6437010251723223`*^9, 3.6437010377179623`*^9}, {
   3.6437011551122637`*^9, 3.6437012459817266`*^9}, {3.643701370301364*^9, 
   3.643701407220009*^9}, {3.643701518580022*^9, 3.643701522526347*^9}, {
   3.643702517090665*^9, 3.643702587463787*^9}, {3.643702631300232*^9, 
   3.6437026370543747`*^9}, {3.643702750362689*^9, 3.643702760800075*^9}, {
   3.643702821898019*^9, 3.643702828253956*^9}, {3.6437029059489*^9, 
   3.6437029079020653`*^9}, {3.6437029431735983`*^9, 3.643702980272038*^9}, {
   3.643703102137313*^9, 3.643703112071394*^9}, {3.6437031894702063`*^9, 
   3.643703215124378*^9}, {3.643703316976391*^9, 3.6437033224141693`*^9}, {
   3.643703374413019*^9, 3.643703427211299*^9}, {3.643703490217187*^9, 
   3.643703564613058*^9}, {3.643703691281543*^9, 3.643703743485059*^9}, {
   3.643703888168742*^9, 3.643703896602737*^9}, {3.6437048267282352`*^9, 
   3.6437048975394363`*^9}, {3.6437057444605293`*^9, 3.643705752190124*^9}, {
   3.643705954972937*^9, 3.643705961153522*^9}, {3.643706002097444*^9, 
   3.6437060109569902`*^9}, {3.643960095615589*^9, 3.643960140330454*^9}, {
   3.643960172355269*^9, 3.643960178084527*^9}, {3.6439603167672043`*^9, 
   3.643960393589735*^9}, {3.643960529153203*^9, 3.643960539005945*^9}, {
   3.6439605742932463`*^9, 3.64396058079244*^9}, {3.64396061788204*^9, 
   3.643960624934157*^9}, {3.643960659673005*^9, 3.6439608155512247`*^9}, {
   3.64396085375667*^9, 3.6439608555258913`*^9}, {3.6439608954629183`*^9, 
   3.64396092812294*^9}, {3.643966136471962*^9, 3.643966143649735*^9}, {
   3.643966178769548*^9, 3.643966372986576*^9}, {3.643966403377626*^9, 
   3.6439666027902184`*^9}, 3.6439666502693167`*^9, {3.6439666996029463`*^9, 
   3.643966708197776*^9}, {3.6439667513430567`*^9, 3.64396680012965*^9}, {
   3.643966834596304*^9, 3.643966837954664*^9}, {3.6439669119436817`*^9, 
   3.643966936915223*^9}, {3.643966972764987*^9, 3.64396697303123*^9}, {
   3.6439671050066013`*^9, 3.643967109691283*^9}, {3.643967832402573*^9, 
   3.6439678378124123`*^9}, {3.643967877320889*^9, 3.643967902883573*^9}, {
   3.643968914149847*^9, 3.643968917104064*^9}, {3.643970410857933*^9, 
   3.643970414988474*^9}, {3.643972531846291*^9, 3.643972568442237*^9}, 
   3.643972599611711*^9, {3.6439731986267138`*^9, 3.6439732406970778`*^9}, {
   3.643973512303945*^9, 3.643973515707995*^9}, 3.644318205529643*^9, {
   3.644318252767625*^9, 3.6443182857972507`*^9}, {3.644318361822673*^9, 
   3.6443183742891893`*^9}, {3.644318494097309*^9, 3.644318497088481*^9}, {
   3.645947962802093*^9, 3.645947991364691*^9}, {3.6463177774999113`*^9, 
   3.64631778482887*^9}, {3.646323014451133*^9, 3.646323045488997*^9}, {
   3.6463231021323*^9, 3.6463231364709578`*^9}, {3.646323571475122*^9, 
   3.646323578035534*^9}, {3.647163278985786*^9, 3.6471632873222637`*^9}, {
   3.647195486979968*^9, 3.64719553524255*^9}, {3.6471957507111*^9, 
   3.64719583572884*^9}, {3.647195877044752*^9, 3.647195969940988*^9}, {
   3.647196032981365*^9, 3.647196098038104*^9}, {3.647196241187873*^9, 
   3.647196514370511*^9}, 3.647196714421215*^9, {3.6471972815225277`*^9, 
   3.647197313787243*^9}, {3.64719762209519*^9, 3.647197652670203*^9}, {
   3.6471981181329803`*^9, 3.647198127063168*^9}, {3.647198204297744*^9, 
   3.647198234123966*^9}, {3.647198299080751*^9, 3.647198356199029*^9}, {
   3.647198399676033*^9, 3.647198415724359*^9}, {3.647198842609527*^9, 
   3.64719886721236*^9}, {3.647236130505217*^9, 3.647236130849965*^9}, {
   3.647242095016677*^9, 3.647242119614949*^9}, {3.647242162816025*^9, 
   3.647242186745997*^9}, {3.651495587713932*^9, 3.651495613513898*^9}, {
   3.6514956681837063`*^9, 3.651495773369631*^9}, {3.651495805140808*^9, 
   3.651495899897871*^9}, {3.651496044087434*^9, 3.651496065745228*^9}, {
   3.6537194084830914`*^9, 3.653719473288549*^9}, 3.653720470026661*^9, {
   3.653720823862599*^9, 3.653720832721386*^9}, {3.653720873185301*^9, 
   3.653720875551272*^9}, {3.68778613293778*^9, 3.687786137262192*^9}, {
   3.730456852013707*^9, 3.730456870769412*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", 
      SubscriptBox["r", "0"]},
     {
      RowBox[{
       RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
       SubscriptBox["r", "1"]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}]}], " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
       SubscriptBox["r", "1"]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], " ", 
       SubscriptBox["r", "1"]}]},
     {
      RowBox[{
       RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
       SubscriptBox["r", "2"]}], 
      RowBox[{
       RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
       SubscriptBox["r", "2"]}], 
      RowBox[{
       SubscriptBox["r", "0"], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
        SubscriptBox["r", "2"]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.730456888227645*^9, 3.7304587058104897`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Centre of mass", "Subsection",
 CellChangeTimes->{{3.730456934373962*^9, 3.730456936694272*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"centre", " ", "of", " ", "mass"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cm", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"ix", "=", "1"}], ",", 
     RowBox[{"ix", "\[LessEqual]", "3"}], ",", 
     RowBox[{"ix", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "natoms"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cm", "[", 
         RowBox[{"[", "ix", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"cm", "[", 
          RowBox[{"[", "ix", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"cart", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "ix"}], "]"}], "]"}], "*", 
          RowBox[{"mass", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"ix", "=", "1"}], ",", 
     RowBox[{"ix", "\[LessEqual]", "3"}], ",", 
     RowBox[{"ix", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cm", "[", 
       RowBox[{"[", "ix", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"cm", "[", 
        RowBox[{"[", "ix", "]"}], "]"}], "/", 
       RowBox[{"Total", "[", "mass", "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.643698497669169*^9, 3.643698627680748*^9}, {
   3.643698665811211*^9, 3.643698956729582*^9}, {3.643699144907583*^9, 
   3.643699224690542*^9}, {3.6436992877012377`*^9, 3.6436993782931843`*^9}, {
   3.643699449311922*^9, 3.643699621174951*^9}, {3.643699683613538*^9, 
   3.643699686085781*^9}, {3.643699742910721*^9, 3.643699868573607*^9}, {
   3.6436999489506283`*^9, 3.6437000682787113`*^9}, {3.643700124534732*^9, 
   3.643700210097245*^9}, {3.643700246559291*^9, 3.6437003476911697`*^9}, {
   3.643700434599622*^9, 3.6437004814126*^9}, {3.643700553505638*^9, 
   3.643700638740032*^9}, {3.6437006742289333`*^9, 3.643700816186289*^9}, {
   3.6437008564735603`*^9, 3.643700885401257*^9}, {3.6437009759526873`*^9, 
   3.643700991333433*^9}, {3.6437010251723223`*^9, 3.6437010377179623`*^9}, {
   3.6437011551122637`*^9, 3.6437012459817266`*^9}, {3.643701370301364*^9, 
   3.643701407220009*^9}, {3.643701518580022*^9, 3.643701522526347*^9}, {
   3.643702517090665*^9, 3.643702587463787*^9}, {3.643702631300232*^9, 
   3.6437026370543747`*^9}, {3.643702750362689*^9, 3.643702760800075*^9}, {
   3.643702821898019*^9, 3.643702828253956*^9}, {3.6437029059489*^9, 
   3.6437029079020653`*^9}, {3.6437029431735983`*^9, 3.643702980272038*^9}, {
   3.643703102137313*^9, 3.643703112071394*^9}, {3.6437031894702063`*^9, 
   3.643703215124378*^9}, {3.643703316976391*^9, 3.6437033224141693`*^9}, {
   3.643703374413019*^9, 3.643703427211299*^9}, {3.643703490217187*^9, 
   3.643703564613058*^9}, {3.643703691281543*^9, 3.643703743485059*^9}, {
   3.643703888168742*^9, 3.643703896602737*^9}, {3.6437048267282352`*^9, 
   3.6437048975394363`*^9}, {3.6437057444605293`*^9, 3.643705752190124*^9}, {
   3.643705954972937*^9, 3.643705961153522*^9}, {3.643706002097444*^9, 
   3.6437060109569902`*^9}, {3.643960095615589*^9, 3.643960140330454*^9}, {
   3.643960172355269*^9, 3.643960178084527*^9}, {3.6439603167672043`*^9, 
   3.643960393589735*^9}, {3.643960529153203*^9, 3.643960539005945*^9}, {
   3.6439605742932463`*^9, 3.64396058079244*^9}, {3.64396061788204*^9, 
   3.643960624934157*^9}, {3.643960659673005*^9, 3.6439608155512247`*^9}, {
   3.64396085375667*^9, 3.6439608555258913`*^9}, {3.6439608954629183`*^9, 
   3.64396092812294*^9}, {3.643966136471962*^9, 3.643966143649735*^9}, {
   3.643966178769548*^9, 3.643966372986576*^9}, {3.643966403377626*^9, 
   3.6439666027902184`*^9}, 3.6439666502693167`*^9, {3.6439666996029463`*^9, 
   3.643966708197776*^9}, {3.6439667513430567`*^9, 3.64396680012965*^9}, {
   3.643966834596304*^9, 3.643966837954664*^9}, {3.6439669119436817`*^9, 
   3.643966936915223*^9}, {3.643966972764987*^9, 3.64396697303123*^9}, {
   3.6439671050066013`*^9, 3.643967109691283*^9}, {3.643967832402573*^9, 
   3.6439678378124123`*^9}, {3.643967877320889*^9, 3.643967902883573*^9}, {
   3.643968914149847*^9, 3.643968917104064*^9}, {3.643970410857933*^9, 
   3.643970414988474*^9}, {3.643972531846291*^9, 3.643972568442237*^9}, 
   3.643972599611711*^9, {3.6439731986267138`*^9, 3.6439732406970778`*^9}, {
   3.643973512303945*^9, 3.643973515707995*^9}, 3.644318205529643*^9, {
   3.644318252767625*^9, 3.6443182857972507`*^9}, {3.644318361822673*^9, 
   3.6443183742891893`*^9}, {3.644318494097309*^9, 3.644318497088481*^9}, {
   3.645947962802093*^9, 3.645947991364691*^9}, {3.6463177774999113`*^9, 
   3.64631778482887*^9}, {3.646323014451133*^9, 3.646323045488997*^9}, {
   3.6463231021323*^9, 3.6463231364709578`*^9}, {3.646323571475122*^9, 
   3.646323578035534*^9}, {3.647163278985786*^9, 3.6471632873222637`*^9}, {
   3.647195486979968*^9, 3.64719553524255*^9}, {3.6471957507111*^9, 
   3.64719583572884*^9}, {3.647195877044752*^9, 3.647195969940988*^9}, {
   3.647196032981365*^9, 3.647196098038104*^9}, {3.647196241187873*^9, 
   3.647196514370511*^9}, 3.647196714421215*^9, {3.6471972815225277`*^9, 
   3.647197313787243*^9}, {3.64719762209519*^9, 3.647197652670203*^9}, {
   3.6471981181329803`*^9, 3.647198127063168*^9}, {3.647198204297744*^9, 
   3.647198234123966*^9}, {3.647198299080751*^9, 3.647198356199029*^9}, {
   3.647198399676033*^9, 3.647198415724359*^9}, {3.647198842609527*^9, 
   3.64719886721236*^9}, {3.647236130505217*^9, 3.647236130849965*^9}, {
   3.647242095016677*^9, 3.647242119614949*^9}, {3.647242162816025*^9, 
   3.647242186745997*^9}, {3.651495587713932*^9, 3.651495613513898*^9}, {
   3.6514956681837063`*^9, 3.651495773369631*^9}, {3.651495805140808*^9, 
   3.651495899897871*^9}, {3.651496044087434*^9, 3.651496065745228*^9}, {
   3.6537194084830914`*^9, 3.653719473288549*^9}, 3.653720470026661*^9, {
   3.653720823862599*^9, 3.653720832721386*^9}, {3.653720873185301*^9, 
   3.653720875551272*^9}, {3.68778613293778*^9, 3.687786157684978*^9}, {
   3.730456966671678*^9, 3.7304569773514013`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Print Cartesian coordinates wrt centre of mass\
\>", "Subsection",
 CellChangeTimes->{{3.730456955388719*^9, 3.7304569630449133`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Cartesian", " ", "coords", " ", "wrt", " ", "centre", " ", "of", " ", 
    "mass"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"ix", "=", "1"}], ",", 
     RowBox[{"ix", "\[LessEqual]", "3"}], ",", 
     RowBox[{"ix", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "natoms"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cart", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "ix"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"cart", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "ix"}], "]"}], "]"}], "-", 
         RowBox[{"cm", "[", 
          RowBox[{"[", "ix", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cart", "=", 
     RowBox[{"cart", "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"cart", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.643698497669169*^9, 3.643698627680748*^9}, {
   3.643698665811211*^9, 3.643698956729582*^9}, {3.643699144907583*^9, 
   3.643699224690542*^9}, {3.6436992877012377`*^9, 3.6436993782931843`*^9}, {
   3.643699449311922*^9, 3.643699621174951*^9}, {3.643699683613538*^9, 
   3.643699686085781*^9}, {3.643699742910721*^9, 3.643699868573607*^9}, {
   3.6436999489506283`*^9, 3.6437000682787113`*^9}, {3.643700124534732*^9, 
   3.643700210097245*^9}, {3.643700246559291*^9, 3.6437003476911697`*^9}, {
   3.643700434599622*^9, 3.6437004814126*^9}, {3.643700553505638*^9, 
   3.643700638740032*^9}, {3.6437006742289333`*^9, 3.643700816186289*^9}, {
   3.6437008564735603`*^9, 3.643700885401257*^9}, {3.6437009759526873`*^9, 
   3.643700991333433*^9}, {3.6437010251723223`*^9, 3.6437010377179623`*^9}, {
   3.6437011551122637`*^9, 3.6437012459817266`*^9}, {3.643701370301364*^9, 
   3.643701407220009*^9}, {3.643701518580022*^9, 3.643701522526347*^9}, {
   3.643702517090665*^9, 3.643702587463787*^9}, {3.643702631300232*^9, 
   3.6437026370543747`*^9}, {3.643702750362689*^9, 3.643702760800075*^9}, {
   3.643702821898019*^9, 3.643702828253956*^9}, {3.6437029059489*^9, 
   3.6437029079020653`*^9}, {3.6437029431735983`*^9, 3.643702980272038*^9}, {
   3.643703102137313*^9, 3.643703112071394*^9}, {3.6437031894702063`*^9, 
   3.643703215124378*^9}, {3.643703316976391*^9, 3.6437033224141693`*^9}, {
   3.643703374413019*^9, 3.643703427211299*^9}, {3.643703490217187*^9, 
   3.643703564613058*^9}, {3.643703691281543*^9, 3.643703743485059*^9}, {
   3.643703888168742*^9, 3.643703896602737*^9}, {3.6437048267282352`*^9, 
   3.6437048975394363`*^9}, {3.6437057444605293`*^9, 3.643705752190124*^9}, {
   3.643705954972937*^9, 3.643705961153522*^9}, {3.643706002097444*^9, 
   3.6437060109569902`*^9}, {3.643960095615589*^9, 3.643960140330454*^9}, {
   3.643960172355269*^9, 3.643960178084527*^9}, {3.6439603167672043`*^9, 
   3.643960393589735*^9}, {3.643960529153203*^9, 3.643960539005945*^9}, {
   3.6439605742932463`*^9, 3.64396058079244*^9}, {3.64396061788204*^9, 
   3.643960624934157*^9}, {3.643960659673005*^9, 3.6439608155512247`*^9}, {
   3.64396085375667*^9, 3.6439608555258913`*^9}, {3.6439608954629183`*^9, 
   3.64396092812294*^9}, {3.643966136471962*^9, 3.643966143649735*^9}, {
   3.643966178769548*^9, 3.643966372986576*^9}, {3.643966403377626*^9, 
   3.6439666027902184`*^9}, 3.6439666502693167`*^9, {3.6439666996029463`*^9, 
   3.643966708197776*^9}, {3.6439667513430567`*^9, 3.64396680012965*^9}, {
   3.643966834596304*^9, 3.643966837954664*^9}, {3.6439669119436817`*^9, 
   3.643966936915223*^9}, {3.643966972764987*^9, 3.64396697303123*^9}, {
   3.6439671050066013`*^9, 3.643967109691283*^9}, {3.643967832402573*^9, 
   3.6439678378124123`*^9}, {3.643967877320889*^9, 3.643967902883573*^9}, {
   3.643968914149847*^9, 3.643968917104064*^9}, {3.643970410857933*^9, 
   3.643970414988474*^9}, {3.643972531846291*^9, 3.643972568442237*^9}, 
   3.643972599611711*^9, {3.6439731986267138`*^9, 3.6439732406970778`*^9}, {
   3.643973512303945*^9, 3.643973515707995*^9}, 3.644318205529643*^9, {
   3.644318252767625*^9, 3.6443182857972507`*^9}, {3.644318361822673*^9, 
   3.6443183742891893`*^9}, {3.644318494097309*^9, 3.644318497088481*^9}, {
   3.645947962802093*^9, 3.645947991364691*^9}, {3.6463177774999113`*^9, 
   3.64631778482887*^9}, {3.646323014451133*^9, 3.646323045488997*^9}, {
   3.6463231021323*^9, 3.6463231364709578`*^9}, {3.646323571475122*^9, 
   3.646323578035534*^9}, {3.647163278985786*^9, 3.6471632873222637`*^9}, {
   3.647195486979968*^9, 3.64719553524255*^9}, {3.6471957507111*^9, 
   3.64719583572884*^9}, {3.647195877044752*^9, 3.647195969940988*^9}, {
   3.647196032981365*^9, 3.647196098038104*^9}, {3.647196241187873*^9, 
   3.647196514370511*^9}, 3.647196714421215*^9, {3.6471972815225277`*^9, 
   3.647197313787243*^9}, {3.64719762209519*^9, 3.647197652670203*^9}, {
   3.6471981181329803`*^9, 3.647198127063168*^9}, {3.647198204297744*^9, 
   3.647198234123966*^9}, {3.647198299080751*^9, 3.647198356199029*^9}, {
   3.647198399676033*^9, 3.647198415724359*^9}, {3.647198842609527*^9, 
   3.64719886721236*^9}, {3.647236130505217*^9, 3.647236130849965*^9}, {
   3.647242095016677*^9, 3.647242119614949*^9}, {3.647242162816025*^9, 
   3.647242186745997*^9}, {3.651495587713932*^9, 3.651495613513898*^9}, {
   3.6514956681837063`*^9, 3.651495773369631*^9}, {3.651495805140808*^9, 
   3.651495899897871*^9}, {3.651496044087434*^9, 3.651496065745228*^9}, {
   3.6537194084830914`*^9, 3.653719473288549*^9}, 3.653720470026661*^9, {
   3.653720823862599*^9, 3.653720832721386*^9}, {3.653720873185301*^9, 
   3.653720875551272*^9}, {3.68778613293778*^9, 3.687786160683922*^9}, {
   3.730456968455112*^9, 3.7304569753767443`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["m", "3"], " ", 
            SubscriptBox["r", "1"]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
            SubscriptBox["m", "4"], " ", 
            SubscriptBox["r", "2"]}]}], ")"}]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
           SubscriptBox["m", "3"], " ", 
           SubscriptBox["r", "1"]}], "-", 
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["m", "4"], " ", 
           SubscriptBox["r", "2"]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          SubscriptBox["m", "2"], " ", 
          SubscriptBox["r", "0"]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
          SubscriptBox["m", "3"], " ", 
          SubscriptBox["r", "1"]}], "+", 
         RowBox[{
          SubscriptBox["m", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["r", "0"], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
             SubscriptBox["r", "2"]}]}], ")"}]}]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["m", "3"], " ", 
            SubscriptBox["r", "1"]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
            SubscriptBox["m", "4"], " ", 
            SubscriptBox["r", "2"]}]}], ")"}]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
           SubscriptBox["m", "3"], " ", 
           SubscriptBox["r", "1"]}], "-", 
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["m", "4"], " ", 
           SubscriptBox["r", "2"]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         SubscriptBox["m", "1"], " ", 
         SubscriptBox["r", "0"]}], "+", 
        RowBox[{
         SubscriptBox["m", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["r", "0"], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["r", "1"]}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
         SubscriptBox["m", "4"], " ", 
         SubscriptBox["r", "2"]}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]]},
     {
      RowBox[{
       RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
          SubscriptBox["r", "1"]}], "-", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["m", "3"], " ", 
            SubscriptBox["r", "1"]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
            SubscriptBox["m", "4"], " ", 
            SubscriptBox["r", "2"]}]}], 
          RowBox[{
           SubscriptBox["m", "1"], "+", 
           SubscriptBox["m", "2"], "+", 
           SubscriptBox["m", "3"], "+", 
           SubscriptBox["m", "4"]}]]}], ")"}]}], 
      RowBox[{
       RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], " ", 
          SubscriptBox["r", "1"]}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["m", "3"], " ", 
            SubscriptBox["r", "1"]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
            SubscriptBox["m", "4"], " ", 
            SubscriptBox["r", "2"]}]}], 
          RowBox[{
           SubscriptBox["m", "1"], "+", 
           SubscriptBox["m", "2"], "+", 
           SubscriptBox["m", "3"], "+", 
           SubscriptBox["m", "4"]}]]}], ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], " ", 
        SubscriptBox["r", "1"]}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{
          SubscriptBox["m", "2"], " ", 
          SubscriptBox["r", "0"]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
          SubscriptBox["m", "3"], " ", 
          SubscriptBox["r", "1"]}], "+", 
         RowBox[{
          SubscriptBox["m", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["r", "0"], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
             SubscriptBox["r", "2"]}]}], ")"}]}]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}]},
     {
      RowBox[{
       RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
          SubscriptBox["r", "2"]}], "-", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["m", "3"], " ", 
            SubscriptBox["r", "1"]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
            SubscriptBox["m", "4"], " ", 
            SubscriptBox["r", "2"]}]}], 
          RowBox[{
           SubscriptBox["m", "1"], "+", 
           SubscriptBox["m", "2"], "+", 
           SubscriptBox["m", "3"], "+", 
           SubscriptBox["m", "4"]}]]}], ")"}]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["m", "1"], "+", 
             SubscriptBox["m", "2"]}], ")"}], " ", 
           SubscriptBox["r", "2"]}], "+", 
          RowBox[{
           SubscriptBox["m", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Sin", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "1"]}], "+", 
             RowBox[{
              RowBox[{"Sin", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
              SubscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      RowBox[{
       SubscriptBox["r", "0"], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
        SubscriptBox["r", "2"]}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{
          SubscriptBox["m", "2"], " ", 
          SubscriptBox["r", "0"]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
          SubscriptBox["m", "3"], " ", 
          SubscriptBox["r", "1"]}], "+", 
         RowBox[{
          SubscriptBox["m", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["r", "0"], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
             SubscriptBox["r", "2"]}]}], ")"}]}]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7304569874576406`*^9, 3.7304587063785954`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["s-matrix and t-matrix", "Section",
 CellChangeTimes->{{3.7304570091983223`*^9, 3.730457021216497*^9}}],

Cell[CellGroupData[{

Cell["Build and print t-matrix", "Subsection",
 CellChangeTimes->{{3.730457029399035*^9, 3.730457034110907*^9}, {
  3.730457100954883*^9, 3.730457102208292*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"T", "-", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tmat", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"natoms", "*", "3"}], ",", 
         RowBox[{"natoms", "*", "3"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xatom", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"x", "=", "1"}], ",", 
     RowBox[{"x", "\[LessEqual]", "3"}], ",", 
     RowBox[{"x", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"atom", "=", "1"}], ",", 
       RowBox[{"atom", "\[LessEqual]", "natoms"}], ",", 
       RowBox[{"atom", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xatom", "++"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"coord", "=", "1"}], ",", 
          RowBox[{"coord", "\[LessEqual]", 
           RowBox[{"natoms", "*", "3"}]}], ",", 
          RowBox[{"coord", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"coord", "\[LessEqual]", "ncoords"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Vibrational", " ", "part"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"tmat", "[", 
              RowBox[{"[", 
               RowBox[{"xatom", ",", "coord"}], "]"}], "]"}], "=", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"cart", "[", 
                RowBox[{"[", 
                 RowBox[{"atom", ",", "x"}], "]"}], "]"}], ",", 
               RowBox[{"coords", "[", 
                RowBox[{"[", "coord", "]"}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"coord", "\[LessEqual]", 
               RowBox[{"ncoords", "+", "3"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Rotational", " ", "part"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"y", "=", "1"}], ",", 
                RowBox[{"y", "\[LessEqual]", "3"}], ",", 
                RowBox[{"y", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"tmat", "[", 
                  RowBox[{"[", 
                   RowBox[{"xatom", ",", "coord"}], "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"tmat", "[", 
                   RowBox[{"[", 
                    RowBox[{"xatom", ",", "coord"}], "]"}], "]"}], "+", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Normal", "[", 
                    RowBox[{"LeviCivitaTensor", "[", "3", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"x", ",", 
                    RowBox[{"coord", "-", "ncoords"}], ",", "y"}], "]"}], 
                    "]"}], "*", 
                   RowBox[{"cart", "[", 
                    RowBox[{"[", 
                    RowBox[{"atom", ",", "y"}], "]"}], "]"}]}]}]}]}], 
               "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"y", "=", 
                RowBox[{"coord", "-", 
                 RowBox[{"(", 
                  RowBox[{"ncoords", "+", "3"}], ")"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"Translational", " ", "part"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"x", "\[Equal]", "y"}], ",", 
                 RowBox[{
                  RowBox[{"tmat", "[", 
                   RowBox[{"[", 
                    RowBox[{"xatom", ",", "coord"}], "]"}], "]"}], "=", 
                  "1"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmat", "=", 
     RowBox[{"tmat", "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"tmat", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.643698497669169*^9, 3.643698627680748*^9}, {
   3.643698665811211*^9, 3.643698956729582*^9}, {3.643699144907583*^9, 
   3.643699224690542*^9}, {3.6436992877012377`*^9, 3.6436993782931843`*^9}, {
   3.643699449311922*^9, 3.643699621174951*^9}, {3.643699683613538*^9, 
   3.643699686085781*^9}, {3.643699742910721*^9, 3.643699868573607*^9}, {
   3.6436999489506283`*^9, 3.6437000682787113`*^9}, {3.643700124534732*^9, 
   3.643700210097245*^9}, {3.643700246559291*^9, 3.6437003476911697`*^9}, {
   3.643700434599622*^9, 3.6437004814126*^9}, {3.643700553505638*^9, 
   3.643700638740032*^9}, {3.6437006742289333`*^9, 3.643700816186289*^9}, {
   3.6437008564735603`*^9, 3.643700885401257*^9}, {3.6437009759526873`*^9, 
   3.643700991333433*^9}, {3.6437010251723223`*^9, 3.6437010377179623`*^9}, {
   3.6437011551122637`*^9, 3.6437012459817266`*^9}, {3.643701370301364*^9, 
   3.643701407220009*^9}, {3.643701518580022*^9, 3.643701522526347*^9}, {
   3.643702517090665*^9, 3.643702587463787*^9}, {3.643702631300232*^9, 
   3.6437026370543747`*^9}, {3.643702750362689*^9, 3.643702760800075*^9}, {
   3.643702821898019*^9, 3.643702828253956*^9}, {3.6437029059489*^9, 
   3.6437029079020653`*^9}, {3.6437029431735983`*^9, 3.643702980272038*^9}, {
   3.643703102137313*^9, 3.643703112071394*^9}, {3.6437031894702063`*^9, 
   3.643703215124378*^9}, {3.643703316976391*^9, 3.6437033224141693`*^9}, {
   3.643703374413019*^9, 3.643703427211299*^9}, {3.643703490217187*^9, 
   3.643703564613058*^9}, {3.643703691281543*^9, 3.643703743485059*^9}, {
   3.643703888168742*^9, 3.643703896602737*^9}, {3.6437048267282352`*^9, 
   3.6437048975394363`*^9}, {3.6437057444605293`*^9, 3.643705752190124*^9}, {
   3.643705954972937*^9, 3.643705961153522*^9}, {3.643706002097444*^9, 
   3.6437060109569902`*^9}, {3.643960095615589*^9, 3.643960140330454*^9}, {
   3.643960172355269*^9, 3.643960178084527*^9}, {3.6439603167672043`*^9, 
   3.643960393589735*^9}, {3.643960529153203*^9, 3.643960539005945*^9}, {
   3.6439605742932463`*^9, 3.64396058079244*^9}, {3.64396061788204*^9, 
   3.643960624934157*^9}, {3.643960659673005*^9, 3.6439608155512247`*^9}, {
   3.64396085375667*^9, 3.6439608555258913`*^9}, {3.6439608954629183`*^9, 
   3.64396092812294*^9}, {3.643966136471962*^9, 3.643966143649735*^9}, {
   3.643966178769548*^9, 3.643966372986576*^9}, {3.643966403377626*^9, 
   3.6439666027902184`*^9}, 3.6439666502693167`*^9, {3.6439666996029463`*^9, 
   3.643966708197776*^9}, {3.6439667513430567`*^9, 3.64396680012965*^9}, {
   3.643966834596304*^9, 3.643966837954664*^9}, {3.6439669119436817`*^9, 
   3.643966936915223*^9}, {3.643966972764987*^9, 3.64396697303123*^9}, {
   3.6439671050066013`*^9, 3.643967109691283*^9}, {3.643967832402573*^9, 
   3.6439678378124123`*^9}, {3.643967877320889*^9, 3.643967902883573*^9}, {
   3.643968914149847*^9, 3.643968917104064*^9}, {3.643970410857933*^9, 
   3.643970414988474*^9}, {3.643972531846291*^9, 3.643972568442237*^9}, 
   3.643972599611711*^9, {3.6439731986267138`*^9, 3.6439732406970778`*^9}, {
   3.643973512303945*^9, 3.643973515707995*^9}, 3.644318205529643*^9, {
   3.644318252767625*^9, 3.6443182857972507`*^9}, {3.644318361822673*^9, 
   3.6443183742891893`*^9}, {3.644318494097309*^9, 3.644318497088481*^9}, {
   3.645947962802093*^9, 3.645947991364691*^9}, {3.6463177774999113`*^9, 
   3.64631778482887*^9}, {3.646323014451133*^9, 3.646323045488997*^9}, {
   3.6463231021323*^9, 3.6463231364709578`*^9}, {3.646323571475122*^9, 
   3.646323578035534*^9}, {3.647163278985786*^9, 3.6471632873222637`*^9}, {
   3.647195486979968*^9, 3.64719553524255*^9}, {3.6471957507111*^9, 
   3.64719583572884*^9}, {3.647195877044752*^9, 3.647195969940988*^9}, {
   3.647196032981365*^9, 3.647196098038104*^9}, {3.647196241187873*^9, 
   3.647196514370511*^9}, 3.647196714421215*^9, {3.6471972815225277`*^9, 
   3.647197313787243*^9}, {3.64719762209519*^9, 3.647197652670203*^9}, {
   3.6471981181329803`*^9, 3.647198127063168*^9}, {3.647198204297744*^9, 
   3.647198234123966*^9}, {3.647198299080751*^9, 3.647198356199029*^9}, {
   3.647198399676033*^9, 3.647198415724359*^9}, {3.647198842609527*^9, 
   3.64719886721236*^9}, {3.647236130505217*^9, 3.647236130849965*^9}, {
   3.647242095016677*^9, 3.647242119614949*^9}, {3.647242162816025*^9, 
   3.647242186745997*^9}, {3.651495587713932*^9, 3.651495613513898*^9}, {
   3.6514956681837063`*^9, 3.651495773369631*^9}, {3.651495805140808*^9, 
   3.651495899897871*^9}, {3.651496044087434*^9, 3.651496065745228*^9}, {
   3.6537194084830914`*^9, 3.653719473288549*^9}, 3.653720470026661*^9, {
   3.653720823862599*^9, 3.653720832721386*^9}, {3.653720873185301*^9, 
   3.653720875551272*^9}, {3.68778613293778*^9, 3.687786167804521*^9}, {
   3.7304570532514353`*^9, 3.7304570794833*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
         SubscriptBox["m", "3"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
         SubscriptBox["m", "4"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
         SubscriptBox["m", "3"], " ", 
         SubscriptBox["r", "1"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
         SubscriptBox["m", "4"], " ", 
         SubscriptBox["r", "2"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
           SubscriptBox["m", "3"], " ", 
           SubscriptBox["r", "1"]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["m", "4"], " ", 
           SubscriptBox["r", "2"]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          SubscriptBox["m", "2"], " ", 
          SubscriptBox["r", "0"]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
          SubscriptBox["m", "3"], " ", 
          SubscriptBox["r", "1"]}], "+", 
         RowBox[{
          SubscriptBox["m", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["r", "0"], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
             SubscriptBox["r", "2"]}]}], ")"}]}]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], " ", 
           SubscriptBox["m", "3"], " ", 
           SubscriptBox["r", "1"]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["m", "4"], " ", 
           SubscriptBox["r", "2"]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], "1", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
         SubscriptBox["m", "3"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
         SubscriptBox["m", "4"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
         SubscriptBox["m", "3"], " ", 
         SubscriptBox["r", "1"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
         SubscriptBox["m", "4"], " ", 
         SubscriptBox["r", "2"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
           SubscriptBox["m", "3"], " ", 
           SubscriptBox["r", "1"]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["m", "4"], " ", 
           SubscriptBox["r", "2"]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], "0", 
      FractionBox[
       RowBox[{
        RowBox[{
         SubscriptBox["m", "1"], " ", 
         SubscriptBox["r", "0"]}], "+", 
        RowBox[{
         SubscriptBox["m", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["r", "0"], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["r", "1"]}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
         SubscriptBox["m", "4"], " ", 
         SubscriptBox["r", "2"]}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], " ", 
           SubscriptBox["m", "3"], " ", 
           SubscriptBox["r", "1"]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["m", "4"], " ", 
           SubscriptBox["r", "2"]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], "1", "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["m", "1"], "+", 
          SubscriptBox["m", "2"], "+", 
          SubscriptBox["m", "4"]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
         SubscriptBox["m", "4"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["m", "1"], "+", 
          SubscriptBox["m", "2"], "+", 
          SubscriptBox["m", "4"]}], ")"}], " ", 
        SubscriptBox["r", "1"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
         SubscriptBox["m", "4"], " ", 
         SubscriptBox["r", "2"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
          SubscriptBox["r", "1"]}], "-", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["m", "3"], " ", 
            SubscriptBox["r", "1"]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
            SubscriptBox["m", "4"], " ", 
            SubscriptBox["r", "2"]}]}], 
          RowBox[{
           SubscriptBox["m", "1"], "+", 
           SubscriptBox["m", "2"], "+", 
           SubscriptBox["m", "3"], "+", 
           SubscriptBox["m", "4"]}]]}], ")"}]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], " ", 
        SubscriptBox["r", "1"]}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{
          SubscriptBox["m", "2"], " ", 
          SubscriptBox["r", "0"]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
          SubscriptBox["m", "3"], " ", 
          SubscriptBox["r", "1"]}], "+", 
         RowBox[{
          SubscriptBox["m", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["r", "0"], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
             SubscriptBox["r", "2"]}]}], ")"}]}]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], " ", 
          SubscriptBox["r", "1"]}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["m", "3"], " ", 
            SubscriptBox["r", "1"]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
            SubscriptBox["m", "4"], " ", 
            SubscriptBox["r", "2"]}]}], 
          RowBox[{
           SubscriptBox["m", "1"], "+", 
           SubscriptBox["m", "2"], "+", 
           SubscriptBox["m", "3"], "+", 
           SubscriptBox["m", "4"]}]]}], ")"}]}], "1", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
         SubscriptBox["m", "3"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["m", "1"], "+", 
          SubscriptBox["m", "2"], "+", 
          SubscriptBox["m", "3"]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Cos", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
         SubscriptBox["m", "3"], " ", 
         SubscriptBox["r", "1"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["m", "1"], "+", 
          SubscriptBox["m", "2"], "+", 
          SubscriptBox["m", "3"]}], ")"}], " ", 
        SubscriptBox["r", "2"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
          SubscriptBox["r", "2"]}], "-", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["m", "3"], " ", 
            SubscriptBox["r", "1"]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
            SubscriptBox["m", "4"], " ", 
            SubscriptBox["r", "2"]}]}], 
          RowBox[{
           SubscriptBox["m", "1"], "+", 
           SubscriptBox["m", "2"], "+", 
           SubscriptBox["m", "3"], "+", 
           SubscriptBox["m", "4"]}]]}], ")"}]}], "0", 
      RowBox[{
       SubscriptBox["r", "0"], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
        SubscriptBox["r", "2"]}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{
          SubscriptBox["m", "2"], " ", 
          SubscriptBox["r", "0"]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
          SubscriptBox["m", "3"], " ", 
          SubscriptBox["r", "1"]}], "+", 
         RowBox[{
          SubscriptBox["m", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["r", "0"], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
             SubscriptBox["r", "2"]}]}], ")"}]}]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["m", "1"], "+", 
              SubscriptBox["m", "2"]}], ")"}], " ", 
            SubscriptBox["r", "2"]}], "+", 
           RowBox[{
            SubscriptBox["m", "3"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
               SubscriptBox["r", "1"]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
               SubscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], "1", "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
        SubscriptBox["m", "3"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
         SubscriptBox["m", "4"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        SubscriptBox["m", "3"], " ", 
        SubscriptBox["r", "1"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
         RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
         SubscriptBox["m", "4"], " ", 
         SubscriptBox["r", "2"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
           SubscriptBox["m", "3"], " ", 
           SubscriptBox["r", "1"]}], "-", 
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["m", "4"], " ", 
           SubscriptBox["r", "2"]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         SubscriptBox["m", "2"], " ", 
         SubscriptBox["r", "0"]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
         SubscriptBox["m", "3"], " ", 
         SubscriptBox["r", "1"]}], "+", 
        RowBox[{
         SubscriptBox["m", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["r", "0"], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
            SubscriptBox["r", "2"]}]}], ")"}]}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["m", "3"], " ", 
            SubscriptBox["r", "1"]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
            SubscriptBox["m", "4"], " ", 
            SubscriptBox["r", "2"]}]}], ")"}]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], "0", "1", "0"},
     {"0", 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
        SubscriptBox["m", "3"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
         SubscriptBox["m", "4"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        SubscriptBox["m", "3"], " ", 
        SubscriptBox["r", "1"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
         RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
         SubscriptBox["m", "4"], " ", 
         SubscriptBox["r", "2"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
           SubscriptBox["m", "3"], " ", 
           SubscriptBox["r", "1"]}], "-", 
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["m", "4"], " ", 
           SubscriptBox["r", "2"]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          SubscriptBox["m", "1"], " ", 
          SubscriptBox["r", "0"]}], "+", 
         RowBox[{
          SubscriptBox["m", "3"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["r", "0"], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
             SubscriptBox["r", "1"]}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
          SubscriptBox["m", "4"], " ", 
          SubscriptBox["r", "2"]}]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["m", "3"], " ", 
            SubscriptBox["r", "1"]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
            SubscriptBox["m", "4"], " ", 
            SubscriptBox["r", "2"]}]}], ")"}]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], "0", "1", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["m", "1"], "+", 
           SubscriptBox["m", "2"], "+", 
           SubscriptBox["m", "4"]}], ")"}]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
         SubscriptBox["m", "4"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
         RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["m", "1"], "+", 
           SubscriptBox["m", "2"], "+", 
           SubscriptBox["m", "4"]}], ")"}], " ", 
         SubscriptBox["r", "1"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
         RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
         SubscriptBox["m", "4"], " ", 
         SubscriptBox["r", "2"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], " ", 
          SubscriptBox["r", "1"]}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["m", "3"], " ", 
            SubscriptBox["r", "1"]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
            SubscriptBox["m", "4"], " ", 
            SubscriptBox["r", "2"]}]}], 
          RowBox[{
           SubscriptBox["m", "1"], "+", 
           SubscriptBox["m", "2"], "+", 
           SubscriptBox["m", "3"], "+", 
           SubscriptBox["m", "4"]}]]}], ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
        SubscriptBox["r", "1"]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{
          SubscriptBox["m", "2"], " ", 
          SubscriptBox["r", "0"]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
          SubscriptBox["m", "3"], " ", 
          SubscriptBox["r", "1"]}], "+", 
         RowBox[{
          SubscriptBox["m", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["r", "0"], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
             SubscriptBox["r", "2"]}]}], ")"}]}]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], "0", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
          SubscriptBox["r", "1"]}], "-", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["m", "3"], " ", 
            SubscriptBox["r", "1"]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
            SubscriptBox["m", "4"], " ", 
            SubscriptBox["r", "2"]}]}], 
          RowBox[{
           SubscriptBox["m", "1"], "+", 
           SubscriptBox["m", "2"], "+", 
           SubscriptBox["m", "3"], "+", 
           SubscriptBox["m", "4"]}]]}], ")"}]}], "0", "1", "0"},
     {"0", 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
        SubscriptBox["m", "3"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["m", "1"], "+", 
          SubscriptBox["m", "2"], "+", 
          SubscriptBox["m", "3"]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        SubscriptBox["m", "3"], " ", 
        SubscriptBox["r", "1"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["m", "1"], "+", 
          SubscriptBox["m", "2"], "+", 
          SubscriptBox["m", "3"]}], ")"}], " ", 
        SubscriptBox["r", "2"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["m", "1"], "+", 
             SubscriptBox["m", "2"]}], ")"}], " ", 
           SubscriptBox["r", "2"]}], "+", 
          RowBox[{
           SubscriptBox["m", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Sin", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "1"]}], "+", 
             RowBox[{
              RowBox[{"Sin", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
              SubscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["r", "0"]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
        SubscriptBox["r", "2"]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{
          SubscriptBox["m", "2"], " ", 
          SubscriptBox["r", "0"]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
          SubscriptBox["m", "3"], " ", 
          SubscriptBox["r", "1"]}], "+", 
         RowBox[{
          SubscriptBox["m", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["r", "0"], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
             SubscriptBox["r", "2"]}]}], ")"}]}]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], "0", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
          SubscriptBox["r", "2"]}], "-", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["m", "3"], " ", 
            SubscriptBox["r", "1"]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
            SubscriptBox["m", "4"], " ", 
            SubscriptBox["r", "2"]}]}], 
          RowBox[{
           SubscriptBox["m", "1"], "+", 
           SubscriptBox["m", "2"], "+", 
           SubscriptBox["m", "3"], "+", 
           SubscriptBox["m", "4"]}]]}], ")"}]}], "0", "1", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "4"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
        SubscriptBox["m", "3"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
         SubscriptBox["m", "4"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
         SubscriptBox["m", "3"], " ", 
         SubscriptBox["r", "1"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
        SubscriptBox["m", "4"], " ", 
        SubscriptBox["r", "2"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], "0", 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
           SubscriptBox["m", "3"], " ", 
           SubscriptBox["r", "1"]}], "-", 
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["m", "4"], " ", 
           SubscriptBox["r", "2"]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
           SubscriptBox["m", "3"], " ", 
           SubscriptBox["r", "1"]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["m", "4"], " ", 
           SubscriptBox["r", "2"]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], "0", "0", "0", "1"},
     {
      FractionBox[
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "3"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
        SubscriptBox["m", "3"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
         SubscriptBox["m", "4"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
         SubscriptBox["m", "3"], " ", 
         SubscriptBox["r", "1"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
        SubscriptBox["m", "4"], " ", 
        SubscriptBox["r", "2"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], "0", 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
           SubscriptBox["m", "3"], " ", 
           SubscriptBox["r", "1"]}], "-", 
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["m", "4"], " ", 
           SubscriptBox["r", "2"]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
           SubscriptBox["m", "3"], " ", 
           SubscriptBox["r", "1"]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["m", "4"], " ", 
           SubscriptBox["r", "2"]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], "0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "4"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      RowBox[{
       RowBox[{"Cos", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         FractionBox[
          SubscriptBox["m", "3"], 
          RowBox[{
           SubscriptBox["m", "1"], "+", 
           SubscriptBox["m", "2"], "+", 
           SubscriptBox["m", "3"], "+", 
           SubscriptBox["m", "4"]}]]}], ")"}]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
         SubscriptBox["m", "4"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["m", "1"], "+", 
          SubscriptBox["m", "2"], "+", 
          SubscriptBox["m", "4"]}], ")"}], " ", 
        SubscriptBox["r", "1"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
        SubscriptBox["m", "4"], " ", 
        SubscriptBox["r", "2"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], "0", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], " ", 
          SubscriptBox["r", "1"]}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["m", "3"], " ", 
            SubscriptBox["r", "1"]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
            SubscriptBox["m", "4"], " ", 
            SubscriptBox["r", "2"]}]}], 
          RowBox[{
           SubscriptBox["m", "1"], "+", 
           SubscriptBox["m", "2"], "+", 
           SubscriptBox["m", "3"], "+", 
           SubscriptBox["m", "4"]}]]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "\[Tau]", "]"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
          SubscriptBox["r", "1"]}], "-", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["m", "3"], " ", 
            SubscriptBox["r", "1"]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
            SubscriptBox["m", "4"], " ", 
            SubscriptBox["r", "2"]}]}], 
          RowBox[{
           SubscriptBox["m", "1"], "+", 
           SubscriptBox["m", "2"], "+", 
           SubscriptBox["m", "3"], "+", 
           SubscriptBox["m", "4"]}]]}], ")"}]}], "0", "0", "0", "1"},
     {
      FractionBox[
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "3"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
        SubscriptBox["m", "3"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      RowBox[{
       RowBox[{"Cos", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox[
          SubscriptBox["m", "4"], 
          RowBox[{
           SubscriptBox["m", "1"], "+", 
           SubscriptBox["m", "2"], "+", 
           SubscriptBox["m", "3"], "+", 
           SubscriptBox["m", "4"]}]]}], ")"}]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
         SubscriptBox["m", "3"], " ", 
         SubscriptBox["r", "1"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["m", "1"], "+", 
           SubscriptBox["m", "2"], "+", 
           SubscriptBox["m", "3"]}], ")"}], " ", 
         SubscriptBox["r", "2"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"], "+", 
         SubscriptBox["m", "3"], "+", 
         SubscriptBox["m", "4"]}]]}], "0", 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["m", "1"], "+", 
             SubscriptBox["m", "2"]}], ")"}], " ", 
           SubscriptBox["r", "2"]}], "+", 
          RowBox[{
           SubscriptBox["m", "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Sin", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "1"]}], "+", 
             RowBox[{
              RowBox[{"Sin", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
              SubscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "\[Tau]", "]"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
          SubscriptBox["r", "2"]}], "-", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["m", "3"], " ", 
            SubscriptBox["r", "1"]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
            SubscriptBox["m", "4"], " ", 
            SubscriptBox["r", "2"]}]}], 
          RowBox[{
           SubscriptBox["m", "1"], "+", 
           SubscriptBox["m", "2"], "+", 
           SubscriptBox["m", "3"], "+", 
           SubscriptBox["m", "4"]}]]}], ")"}]}], "0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7304570900104733`*^9, 3.730458706863963*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Print determinant of t-matix.  If this samples a region of coordinate space \
that causes it to go to zero then the s-matrix will be singular.\
\>", "Subsection",
 CellChangeTimes->{{3.7304571153689537`*^9, 3.730457148961693*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Det", "[", "tmat", "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.643698497669169*^9, 3.643698627680748*^9}, {
   3.643698665811211*^9, 3.643698956729582*^9}, {3.643699144907583*^9, 
   3.643699224690542*^9}, {3.6436992877012377`*^9, 3.6436993782931843`*^9}, {
   3.643699449311922*^9, 3.643699621174951*^9}, {3.643699683613538*^9, 
   3.643699686085781*^9}, {3.643699742910721*^9, 3.643699868573607*^9}, {
   3.6436999489506283`*^9, 3.6437000682787113`*^9}, {3.643700124534732*^9, 
   3.643700210097245*^9}, {3.643700246559291*^9, 3.6437003476911697`*^9}, {
   3.643700434599622*^9, 3.6437004814126*^9}, {3.643700553505638*^9, 
   3.643700638740032*^9}, {3.6437006742289333`*^9, 3.643700816186289*^9}, {
   3.6437008564735603`*^9, 3.643700885401257*^9}, {3.6437009759526873`*^9, 
   3.643700991333433*^9}, {3.6437010251723223`*^9, 3.6437010377179623`*^9}, {
   3.6437011551122637`*^9, 3.6437012459817266`*^9}, {3.643701370301364*^9, 
   3.643701407220009*^9}, {3.643701518580022*^9, 3.643701522526347*^9}, {
   3.643702517090665*^9, 3.643702587463787*^9}, {3.643702631300232*^9, 
   3.6437026370543747`*^9}, {3.643702750362689*^9, 3.643702760800075*^9}, {
   3.643702821898019*^9, 3.643702828253956*^9}, {3.6437029059489*^9, 
   3.6437029079020653`*^9}, {3.6437029431735983`*^9, 3.643702980272038*^9}, {
   3.643703102137313*^9, 3.643703112071394*^9}, {3.6437031894702063`*^9, 
   3.643703215124378*^9}, {3.643703316976391*^9, 3.6437033224141693`*^9}, {
   3.643703374413019*^9, 3.643703427211299*^9}, {3.643703490217187*^9, 
   3.643703564613058*^9}, {3.643703691281543*^9, 3.643703743485059*^9}, {
   3.643703888168742*^9, 3.643703896602737*^9}, {3.6437048267282352`*^9, 
   3.6437048975394363`*^9}, {3.6437057444605293`*^9, 3.643705752190124*^9}, {
   3.643705954972937*^9, 3.643705961153522*^9}, {3.643706002097444*^9, 
   3.6437060109569902`*^9}, {3.643960095615589*^9, 3.643960140330454*^9}, {
   3.643960172355269*^9, 3.643960178084527*^9}, {3.6439603167672043`*^9, 
   3.643960393589735*^9}, {3.643960529153203*^9, 3.643960539005945*^9}, {
   3.6439605742932463`*^9, 3.64396058079244*^9}, {3.64396061788204*^9, 
   3.643960624934157*^9}, {3.643960659673005*^9, 3.6439608155512247`*^9}, {
   3.64396085375667*^9, 3.6439608555258913`*^9}, {3.6439608954629183`*^9, 
   3.64396092812294*^9}, {3.643966136471962*^9, 3.643966143649735*^9}, {
   3.643966178769548*^9, 3.643966372986576*^9}, {3.643966403377626*^9, 
   3.6439666027902184`*^9}, 3.6439666502693167`*^9, {3.6439666996029463`*^9, 
   3.643966708197776*^9}, {3.6439667513430567`*^9, 3.64396680012965*^9}, {
   3.643966834596304*^9, 3.643966837954664*^9}, {3.6439669119436817`*^9, 
   3.643966936915223*^9}, {3.643966972764987*^9, 3.64396697303123*^9}, {
   3.6439671050066013`*^9, 3.643967109691283*^9}, {3.643967832402573*^9, 
   3.6439678378124123`*^9}, {3.643967877320889*^9, 3.643967902883573*^9}, {
   3.643968914149847*^9, 3.643968917104064*^9}, {3.643970410857933*^9, 
   3.643970414988474*^9}, {3.643972531846291*^9, 3.643972568442237*^9}, 
   3.643972599611711*^9, {3.6439731986267138`*^9, 3.6439732406970778`*^9}, {
   3.643973512303945*^9, 3.643973515707995*^9}, 3.644318205529643*^9, {
   3.644318252767625*^9, 3.6443182857972507`*^9}, {3.644318361822673*^9, 
   3.6443183742891893`*^9}, {3.644318494097309*^9, 3.644318497088481*^9}, {
   3.645947962802093*^9, 3.645947991364691*^9}, {3.6463177774999113`*^9, 
   3.64631778482887*^9}, {3.646323014451133*^9, 3.646323045488997*^9}, {
   3.6463231021323*^9, 3.6463231364709578`*^9}, {3.646323571475122*^9, 
   3.646323578035534*^9}, {3.647163278985786*^9, 3.6471632873222637`*^9}, {
   3.647195486979968*^9, 3.64719553524255*^9}, {3.6471957507111*^9, 
   3.64719583572884*^9}, {3.647195877044752*^9, 3.647195969940988*^9}, {
   3.647196032981365*^9, 3.647196098038104*^9}, {3.647196241187873*^9, 
   3.647196514370511*^9}, 3.647196714421215*^9, {3.6471972815225277`*^9, 
   3.647197313787243*^9}, {3.64719762209519*^9, 3.647197652670203*^9}, {
   3.6471981181329803`*^9, 3.647198127063168*^9}, {3.647198204297744*^9, 
   3.647198234123966*^9}, {3.647198299080751*^9, 3.647198356199029*^9}, {
   3.647198399676033*^9, 3.647198415724359*^9}, {3.647198842609527*^9, 
   3.64719886721236*^9}, {3.647236130505217*^9, 3.647236130849965*^9}, {
   3.647242095016677*^9, 3.647242119614949*^9}, {3.647242162816025*^9, 
   3.647242186745997*^9}, {3.651495587713932*^9, 3.651495613513898*^9}, {
   3.6514956681837063`*^9, 3.651495773369631*^9}, {3.651495805140808*^9, 
   3.651495899897871*^9}, {3.651496044087434*^9, 3.651496065745228*^9}, {
   3.6537194084830914`*^9, 3.653719473288549*^9}, 3.653720470026661*^9, {
   3.653720823862599*^9, 3.653720832721386*^9}, {3.653720873185301*^9, 
   3.653720875551272*^9}, {3.68778613293778*^9, 3.6877861722183037`*^9}, {
   3.687787124064843*^9, 3.6877871416932364`*^9}, 3.6877872283670483`*^9, {
   3.687787271570245*^9, 3.687787271874476*^9}, {3.6877874085885487`*^9, 
   3.687787411142915*^9}, {3.687787480326893*^9, 3.6877874806868477`*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"Sin", "[", 
   SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
  RowBox[{"Sin", "[", 
   SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
  SubsuperscriptBox["r", "0", "2"], " ", 
  SubsuperscriptBox["r", "1", "2"], " ", 
  SubsuperscriptBox["r", "2", "2"]}]], "Output",
 CellChangeTimes->{3.687787422479225*^9, 3.687787549699614*^9, 
  3.7304571843721237`*^9, 3.7304587850175247`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Construct and print s-matrix", "Subsection",
 CellChangeTimes->{
  3.730457216261632*^9, {3.730457515837888*^9, 3.730457515957762*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"smat", "=", 
   RowBox[{
    RowBox[{"Inverse", "[", "tmat", "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"smat", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.643698497669169*^9, 3.643698627680748*^9}, {
   3.643698665811211*^9, 3.643698956729582*^9}, {3.643699144907583*^9, 
   3.643699224690542*^9}, {3.6436992877012377`*^9, 3.6436993782931843`*^9}, {
   3.643699449311922*^9, 3.643699621174951*^9}, {3.643699683613538*^9, 
   3.643699686085781*^9}, {3.643699742910721*^9, 3.643699868573607*^9}, {
   3.6436999489506283`*^9, 3.6437000682787113`*^9}, {3.643700124534732*^9, 
   3.643700210097245*^9}, {3.643700246559291*^9, 3.6437003476911697`*^9}, {
   3.643700434599622*^9, 3.6437004814126*^9}, {3.643700553505638*^9, 
   3.643700638740032*^9}, {3.6437006742289333`*^9, 3.643700816186289*^9}, {
   3.6437008564735603`*^9, 3.643700885401257*^9}, {3.6437009759526873`*^9, 
   3.643700991333433*^9}, {3.6437010251723223`*^9, 3.6437010377179623`*^9}, {
   3.6437011551122637`*^9, 3.6437012459817266`*^9}, {3.643701370301364*^9, 
   3.643701407220009*^9}, {3.643701518580022*^9, 3.643701522526347*^9}, {
   3.643702517090665*^9, 3.643702587463787*^9}, {3.643702631300232*^9, 
   3.6437026370543747`*^9}, {3.643702750362689*^9, 3.643702760800075*^9}, {
   3.643702821898019*^9, 3.643702828253956*^9}, {3.6437029059489*^9, 
   3.6437029079020653`*^9}, {3.6437029431735983`*^9, 3.643702980272038*^9}, {
   3.643703102137313*^9, 3.643703112071394*^9}, {3.6437031894702063`*^9, 
   3.643703215124378*^9}, {3.643703316976391*^9, 3.6437033224141693`*^9}, {
   3.643703374413019*^9, 3.643703427211299*^9}, {3.643703490217187*^9, 
   3.643703564613058*^9}, {3.643703691281543*^9, 3.643703743485059*^9}, {
   3.643703888168742*^9, 3.643703896602737*^9}, {3.6437048267282352`*^9, 
   3.6437048975394363`*^9}, {3.6437057444605293`*^9, 3.643705752190124*^9}, {
   3.643705954972937*^9, 3.643705961153522*^9}, {3.643706002097444*^9, 
   3.6437060109569902`*^9}, {3.643960095615589*^9, 3.643960140330454*^9}, {
   3.643960172355269*^9, 3.643960178084527*^9}, {3.6439603167672043`*^9, 
   3.643960393589735*^9}, {3.643960529153203*^9, 3.643960539005945*^9}, {
   3.6439605742932463`*^9, 3.64396058079244*^9}, {3.64396061788204*^9, 
   3.643960624934157*^9}, {3.643960659673005*^9, 3.6439608155512247`*^9}, {
   3.64396085375667*^9, 3.6439608555258913`*^9}, {3.6439608954629183`*^9, 
   3.64396092812294*^9}, {3.643966136471962*^9, 3.643966143649735*^9}, {
   3.643966178769548*^9, 3.643966372986576*^9}, {3.643966403377626*^9, 
   3.6439666027902184`*^9}, 3.6439666502693167`*^9, {3.6439666996029463`*^9, 
   3.643966708197776*^9}, {3.6439667513430567`*^9, 3.64396680012965*^9}, {
   3.643966834596304*^9, 3.643966837954664*^9}, {3.6439669119436817`*^9, 
   3.643966936915223*^9}, {3.643966972764987*^9, 3.64396697303123*^9}, {
   3.6439671050066013`*^9, 3.643967109691283*^9}, {3.643967832402573*^9, 
   3.6439678378124123`*^9}, {3.643967877320889*^9, 3.643967902883573*^9}, {
   3.643968914149847*^9, 3.643968917104064*^9}, {3.643970410857933*^9, 
   3.643970414988474*^9}, {3.643972531846291*^9, 3.643972568442237*^9}, 
   3.643972599611711*^9, {3.6439731986267138`*^9, 3.6439732406970778`*^9}, {
   3.643973512303945*^9, 3.643973515707995*^9}, 3.644318205529643*^9, {
   3.644318252767625*^9, 3.6443182857972507`*^9}, {3.644318361822673*^9, 
   3.6443183742891893`*^9}, {3.644318494097309*^9, 3.644318497088481*^9}, {
   3.645947962802093*^9, 3.645947991364691*^9}, {3.6463177774999113`*^9, 
   3.64631778482887*^9}, {3.646323014451133*^9, 3.646323045488997*^9}, {
   3.6463231021323*^9, 3.6463231364709578`*^9}, {3.646323571475122*^9, 
   3.646323578035534*^9}, {3.647163278985786*^9, 3.6471632873222637`*^9}, {
   3.647195486979968*^9, 3.64719553524255*^9}, {3.6471957507111*^9, 
   3.64719583572884*^9}, {3.647195877044752*^9, 3.647195969940988*^9}, {
   3.647196032981365*^9, 3.647196098038104*^9}, {3.647196241187873*^9, 
   3.647196514370511*^9}, 3.647196714421215*^9, {3.6471972815225277`*^9, 
   3.647197313787243*^9}, {3.64719762209519*^9, 3.647197652670203*^9}, {
   3.6471981181329803`*^9, 3.647198127063168*^9}, {3.647198204297744*^9, 
   3.647198234123966*^9}, {3.647198299080751*^9, 3.647198356199029*^9}, {
   3.647198399676033*^9, 3.647198415724359*^9}, {3.647198842609527*^9, 
   3.64719886721236*^9}, {3.647236130505217*^9, 3.647236130849965*^9}, {
   3.647242095016677*^9, 3.647242119614949*^9}, {3.647242162816025*^9, 
   3.647242186745997*^9}, {3.651495587713932*^9, 3.651495613513898*^9}, {
   3.6514956681837063`*^9, 3.651495773369631*^9}, {3.651495805140808*^9, 
   3.651495899897871*^9}, {3.651496044087434*^9, 3.651496065745228*^9}, {
   3.6537194084830914`*^9, 3.653719473288549*^9}, 3.653720470026661*^9, {
   3.653720823862599*^9, 3.653720832721386*^9}, {3.653720873185301*^9, 
   3.653720875551272*^9}, {3.68778613293778*^9, 3.6877861722183037`*^9}, {
   3.687787124064843*^9, 3.687787127737281*^9}, {3.730457200540861*^9, 
   3.730457200836987*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "1", "0", "0"},
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "\[Tau]", "]"}]}], " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], "0", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], "0", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], "0", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}]}], " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], "0", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "0", 
      RowBox[{"-", 
       RowBox[{"Cos", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "\[Tau]", "]"}]}], " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], "0", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], "0", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}]}], " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], "0", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], "0", 
      RowBox[{"-", 
       RowBox[{"Cos", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], "0", 
      RowBox[{"Cos", "[", 
       SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]},
     {
      RowBox[{
       RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           SubscriptBox["r", "0"]]}], "-", 
         FractionBox[
          RowBox[{"Cos", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], 
          SubscriptBox["r", "1"]]}], ")"}]}], 
      FractionBox[
       RowBox[{"Cos", "[", "\[Tau]", "]"}], 
       SubscriptBox["r", "0"]], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], 
       SubscriptBox["r", "1"]], "0", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          SubscriptBox["r", "0"]], "+", 
         FractionBox[
          RowBox[{"Cos", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], 
          SubscriptBox["r", "1"]]}], ")"}]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Sin", "[", "\[Tau]", "]"}], 
        SubscriptBox["r", "0"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
         RowBox[{"Sin", "[", "\[Tau]", "]"}]}], 
        SubscriptBox["r", "1"]]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], 
        SubscriptBox["r", "1"]]}], "0", 
      FractionBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], 
       SubscriptBox["r", "1"]], "0"},
     {
      FractionBox[
       RowBox[{"Cos", "[", "\[Tau]", "]"}], 
       SubscriptBox["r", "0"]], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           SubscriptBox["r", "0"]]}], "-", 
         FractionBox[
          RowBox[{"Cos", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], 
          SubscriptBox["r", "2"]]}], ")"}]}], "0", 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
       SubscriptBox["r", "2"]], 
      FractionBox[
       RowBox[{"Sin", "[", "\[Tau]", "]"}], 
       SubscriptBox["r", "0"]], 
      RowBox[{
       RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           SubscriptBox["r", "0"]]}], "-", 
         FractionBox[
          RowBox[{"Cos", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], 
          SubscriptBox["r", "2"]]}], ")"}]}], "0", 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}]}], 
       SubscriptBox["r", "2"]], "0", 
      FractionBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], 
       SubscriptBox["r", "2"]], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], 
        SubscriptBox["r", "2"]]}]},
     {
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Csc", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
           SubscriptBox["r", "0"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cot", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "-", 
             RowBox[{"Cot", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], ")"}], 
           " ", 
           SubscriptBox["r", "1"]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        SubscriptBox["r", "0"], " ", 
        SubscriptBox["r", "1"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Csc", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["r", "0"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cot", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], "+", 
             RowBox[{"Cot", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], ")"}], 
           " ", 
           SubscriptBox["r", "2"]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        SubscriptBox["r", "0"], " ", 
        SubscriptBox["r", "2"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Csc", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
         RowBox[{"Sin", "[", "\[Tau]", "]"}]}], 
        RowBox[{"2", " ", 
         SubscriptBox["r", "1"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Csc", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
         RowBox[{"Sin", "[", "\[Tau]", "]"}]}], 
        RowBox[{"2", " ", 
         SubscriptBox["r", "2"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Csc", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
           SubscriptBox["r", "0"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cot", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "+", 
             RowBox[{"Cot", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], ")"}], 
           " ", 
           SubscriptBox["r", "1"]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        SubscriptBox["r", "0"], " ", 
        SubscriptBox["r", "1"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Csc", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
            SubscriptBox["r", "0"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cot", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "+", 
              RowBox[{"Cot", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], ")"}], 
            " ", 
            SubscriptBox["r", "2"]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         SubscriptBox["r", "0"], " ", 
         SubscriptBox["r", "2"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Csc", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], 
        RowBox[{"2", " ", 
         SubscriptBox["r", "1"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Csc", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
       RowBox[{"2", " ", 
        SubscriptBox["r", "2"]}]], "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      FractionBox["1", 
       SubscriptBox["r", "0"]], 
      RowBox[{"-", 
       FractionBox["1", 
        SubscriptBox["r", "0"]]}], "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox["1", 
        SubscriptBox["r", "0"]]}], 
      FractionBox["1", 
       SubscriptBox["r", "0"]], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Csc", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["r", "0"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cot", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "+", 
              RowBox[{"Cot", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], ")"}], 
            " ", 
            SubscriptBox["r", "1"]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         SubscriptBox["r", "0"], " ", 
         SubscriptBox["r", "1"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Csc", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["r", "0"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cot", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "+", 
             RowBox[{"Cot", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], ")"}], 
           " ", 
           SubscriptBox["r", "2"]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        SubscriptBox["r", "0"], " ", 
        SubscriptBox["r", "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Csc", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}]}], 
       RowBox[{"2", " ", 
        SubscriptBox["r", "1"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Csc", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
         RowBox[{"Sin", "[", "\[Tau]", "]"}]}], 
        RowBox[{"2", " ", 
         SubscriptBox["r", "2"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Csc", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["r", "0"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cot", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "-", 
              RowBox[{"Cot", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], ")"}], 
            " ", 
            SubscriptBox["r", "1"]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         SubscriptBox["r", "0"], " ", 
         SubscriptBox["r", "1"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Csc", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
            SubscriptBox["r", "0"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Cot", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], "+", 
              RowBox[{"Cot", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], ")"}], 
            " ", 
            SubscriptBox["r", "2"]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         SubscriptBox["r", "0"], " ", 
         SubscriptBox["r", "2"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Csc", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], 
       RowBox[{"2", " ", 
        SubscriptBox["r", "1"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Csc", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
       RowBox[{"2", " ", 
        SubscriptBox["r", "2"]}]], "0", "0", "0", "0"},
     {
      FractionBox[
       SubscriptBox["m", "1"], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       SubscriptBox["m", "2"], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       SubscriptBox["m", "3"], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       SubscriptBox["m", "4"], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      FractionBox[
       SubscriptBox["m", "1"], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       SubscriptBox["m", "2"], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       SubscriptBox["m", "3"], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       SubscriptBox["m", "4"], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       SubscriptBox["m", "1"], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       SubscriptBox["m", "2"], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       SubscriptBox["m", "3"], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], 
      FractionBox[
       SubscriptBox["m", "4"], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.730457564918223*^9, 3.7304588686635723`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["G-matrix", "Section",
 CellChangeTimes->{{3.7304576006738997`*^9, 3.730457601856639*^9}}],

Cell[CellGroupData[{

Cell["Construct and print G-matrix", "Subsection",
 CellChangeTimes->{{3.7304576094897118`*^9, 3.730457618832803*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gmat", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"natoms", "*", "3"}], ",", 
       RowBox[{"natoms", "*", "3"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"icoord", "=", "1"}], ",", 
   RowBox[{"icoord", "\[LessEqual]", 
    RowBox[{"natoms", "*", "3"}]}], ",", 
   RowBox[{"icoord", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"jcoord", "=", "1"}], ",", 
     RowBox[{"jcoord", "\[LessEqual]", 
      RowBox[{"natoms", "*", "3"}]}], ",", 
     RowBox[{"jcoord", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xatom", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"x", "=", "1"}], ",", 
        RowBox[{"x", "\[LessEqual]", "3"}], ",", 
        RowBox[{"x", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"atom", "=", "1"}], ",", 
          RowBox[{"atom", "\[LessEqual]", "natoms"}], ",", 
          RowBox[{"atom", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"xatom", "++"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"gmat", "[", 
             RowBox[{"[", 
              RowBox[{"icoord", ",", "jcoord"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"gmat", "[", 
              RowBox[{"[", 
               RowBox[{"icoord", ",", "jcoord"}], "]"}], "]"}], "+", 
             RowBox[{
              RowBox[{"smat", "[", 
               RowBox[{"[", 
                RowBox[{"icoord", ",", "xatom"}], "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"smat", "[", 
                RowBox[{"[", 
                 RowBox[{"jcoord", ",", "xatom"}], "]"}], "]"}], "/", 
               RowBox[{"mass", "[", 
                RowBox[{"[", "atom", "]"}], "]"}]}]}]}]}]}]}], 
         "\[IndentingNewLine]", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gmat", "=", 
   RowBox[{"gmat", "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gmat", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.643698497669169*^9, 3.643698627680748*^9}, {
   3.643698665811211*^9, 3.643698956729582*^9}, {3.643699144907583*^9, 
   3.643699224690542*^9}, {3.6436992877012377`*^9, 3.6436993782931843`*^9}, {
   3.643699449311922*^9, 3.643699621174951*^9}, {3.643699683613538*^9, 
   3.643699686085781*^9}, {3.643699742910721*^9, 3.643699868573607*^9}, {
   3.6436999489506283`*^9, 3.6437000682787113`*^9}, {3.643700124534732*^9, 
   3.643700210097245*^9}, {3.643700246559291*^9, 3.6437003476911697`*^9}, {
   3.643700434599622*^9, 3.6437004814126*^9}, {3.643700553505638*^9, 
   3.643700638740032*^9}, {3.6437006742289333`*^9, 3.643700816186289*^9}, {
   3.6437008564735603`*^9, 3.643700885401257*^9}, {3.6437009759526873`*^9, 
   3.643700991333433*^9}, {3.6437010251723223`*^9, 3.6437010377179623`*^9}, {
   3.6437011551122637`*^9, 3.6437012459817266`*^9}, {3.643701370301364*^9, 
   3.643701407220009*^9}, {3.643701518580022*^9, 3.643701522526347*^9}, {
   3.643702517090665*^9, 3.643702587463787*^9}, {3.643702631300232*^9, 
   3.6437026370543747`*^9}, {3.643702750362689*^9, 3.643702760800075*^9}, {
   3.643702821898019*^9, 3.643702828253956*^9}, {3.6437029059489*^9, 
   3.6437029079020653`*^9}, {3.6437029431735983`*^9, 3.643702980272038*^9}, {
   3.643703102137313*^9, 3.643703112071394*^9}, {3.6437031894702063`*^9, 
   3.643703215124378*^9}, {3.643703316976391*^9, 3.6437033224141693`*^9}, {
   3.643703374413019*^9, 3.643703427211299*^9}, {3.643703490217187*^9, 
   3.643703564613058*^9}, {3.643703691281543*^9, 3.643703743485059*^9}, {
   3.643703888168742*^9, 3.643703896602737*^9}, {3.6437048267282352`*^9, 
   3.6437048975394363`*^9}, {3.6437057444605293`*^9, 3.643705752190124*^9}, {
   3.643705954972937*^9, 3.643705961153522*^9}, {3.643706002097444*^9, 
   3.6437060109569902`*^9}, {3.643960095615589*^9, 3.643960140330454*^9}, {
   3.643960172355269*^9, 3.643960178084527*^9}, {3.6439603167672043`*^9, 
   3.643960393589735*^9}, {3.643960529153203*^9, 3.643960539005945*^9}, {
   3.6439605742932463`*^9, 3.64396058079244*^9}, {3.64396061788204*^9, 
   3.643960624934157*^9}, {3.643960659673005*^9, 3.6439608155512247`*^9}, {
   3.64396085375667*^9, 3.6439608555258913`*^9}, {3.6439608954629183`*^9, 
   3.64396092812294*^9}, {3.643966136471962*^9, 3.643966143649735*^9}, {
   3.643966178769548*^9, 3.643966372986576*^9}, {3.643966403377626*^9, 
   3.6439666027902184`*^9}, 3.6439666502693167`*^9, {3.6439666996029463`*^9, 
   3.643966708197776*^9}, {3.6439667513430567`*^9, 3.64396680012965*^9}, {
   3.643966834596304*^9, 3.643966837954664*^9}, {3.6439669119436817`*^9, 
   3.643966936915223*^9}, {3.643966972764987*^9, 3.64396697303123*^9}, {
   3.6439671050066013`*^9, 3.643967109691283*^9}, {3.643967832402573*^9, 
   3.6439678378124123`*^9}, {3.643967877320889*^9, 3.643967902883573*^9}, {
   3.643968914149847*^9, 3.643968917104064*^9}, {3.643970410857933*^9, 
   3.643970414988474*^9}, {3.643972531846291*^9, 3.643972568442237*^9}, 
   3.643972599611711*^9, {3.6439731986267138`*^9, 3.6439732406970778`*^9}, {
   3.643973512303945*^9, 3.643973515707995*^9}, 3.644318205529643*^9, {
   3.644318252767625*^9, 3.6443182857972507`*^9}, {3.644318361822673*^9, 
   3.6443183742891893`*^9}, {3.644318494097309*^9, 3.644318497088481*^9}, {
   3.645947962802093*^9, 3.645947991364691*^9}, {3.6463177774999113`*^9, 
   3.64631778482887*^9}, {3.646323014451133*^9, 3.646323045488997*^9}, {
   3.6463231021323*^9, 3.6463231364709578`*^9}, {3.646323571475122*^9, 
   3.646323578035534*^9}, {3.647163278985786*^9, 3.6471632873222637`*^9}, {
   3.647195486979968*^9, 3.64719553524255*^9}, {3.6471957507111*^9, 
   3.64719583572884*^9}, {3.647195877044752*^9, 3.647195969940988*^9}, {
   3.647196032981365*^9, 3.647196098038104*^9}, {3.647196241187873*^9, 
   3.647196514370511*^9}, 3.647196714421215*^9, {3.6471972815225277`*^9, 
   3.647197313787243*^9}, {3.64719762209519*^9, 3.647197652670203*^9}, {
   3.6471981181329803`*^9, 3.647198127063168*^9}, {3.647198204297744*^9, 
   3.647198234123966*^9}, {3.647198299080751*^9, 3.647198356199029*^9}, {
   3.647198399676033*^9, 3.647198415724359*^9}, {3.647198842609527*^9, 
   3.64719886721236*^9}, {3.647236130505217*^9, 3.647236130849965*^9}, {
   3.647242095016677*^9, 3.647242119614949*^9}, {3.647242162816025*^9, 
   3.647242186745997*^9}, {3.651495587713932*^9, 3.651495613513898*^9}, {
   3.6514956681837063`*^9, 3.651495773369631*^9}, {3.651495805140808*^9, 
   3.651495899897871*^9}, {3.651496044087434*^9, 3.651496065745228*^9}, {
   3.6537194084830914`*^9, 3.653719473288549*^9}, 3.653720470026661*^9, {
   3.653720823862599*^9, 3.653720832721386*^9}, {3.653720873185301*^9, 
   3.653720875551272*^9}, {3.68778613293778*^9, 3.687786176974893*^9}, {
   3.730457564562428*^9, 3.730457566769978*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", 
        SubscriptBox["m", "1"]], "+", 
       FractionBox["1", 
        SubscriptBox["m", "2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], 
        SubscriptBox["m", "1"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], 
        SubscriptBox["m", "2"]]}], 
      FractionBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["r", "1"]}]], 
      FractionBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], 
       RowBox[{
        SubscriptBox["m", "2"], " ", 
        SubscriptBox["r", "2"]}]], "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], 
        SubscriptBox["m", "1"]]}], 
      RowBox[{
       FractionBox["1", 
        SubscriptBox["m", "1"]], "+", 
       FractionBox["1", 
        SubscriptBox["m", "3"]]}], "0", 
      FractionBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["r", "0"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Tau]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], 
        RowBox[{
         SubscriptBox["m", "1"], " ", 
         SubscriptBox["r", "0"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Cot", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["r", "0"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["r", "0"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["r", "0"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Cot", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["r", "0"]}]], "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Cos", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], 
        SubscriptBox["m", "2"]]}], "0", 
      RowBox[{
       FractionBox["1", 
        SubscriptBox["m", "2"]], "+", 
       FractionBox["1", 
        SubscriptBox["m", "4"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Tau]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
        RowBox[{
         SubscriptBox["m", "2"], " ", 
         SubscriptBox["r", "0"]}]]}], 
      FractionBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], 
       RowBox[{
        SubscriptBox["m", "2"], " ", 
        SubscriptBox["r", "0"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Cot", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
       RowBox[{
        SubscriptBox["m", "2"], " ", 
        SubscriptBox["r", "0"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
       RowBox[{
        SubscriptBox["m", "2"], " ", 
        SubscriptBox["r", "0"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
        RowBox[{
         SubscriptBox["m", "2"], " ", 
         SubscriptBox["r", "0"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Cot", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
         RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
        RowBox[{
         SubscriptBox["m", "2"], " ", 
         SubscriptBox["r", "0"]}]]}], "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["r", "1"]}]], 
      FractionBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["r", "0"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Tau]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
        RowBox[{
         SubscriptBox["m", "2"], " ", 
         SubscriptBox["r", "0"]}]]}], 
      RowBox[{
       FractionBox["1", 
        RowBox[{
         SubscriptBox["m", "2"], " ", 
         SubsuperscriptBox["r", "0", "2"]}]], "+", 
       FractionBox[
        RowBox[{
         FractionBox["1", 
          SubsuperscriptBox["r", "0", "2"]], "+", 
         FractionBox["1", 
          SubsuperscriptBox["r", "1", "2"]], "+", 
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], 
          RowBox[{
           SubscriptBox["r", "0"], " ", 
           SubscriptBox["r", "1"]}]]}], 
        SubscriptBox["m", "1"]], "+", 
       FractionBox["1", 
        RowBox[{
         SubscriptBox["m", "3"], " ", 
         SubsuperscriptBox["r", "1", "2"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Tau]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["m", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
               SubscriptBox["r", "0"]}], "+", 
              SubscriptBox["r", "1"]}], ")"}], " ", 
            SubscriptBox["r", "2"]}], "+", 
           RowBox[{
            SubscriptBox["m", "1"], " ", 
            SubscriptBox["r", "1"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
               SubscriptBox["r", "0"]}], "+", 
              SubscriptBox["r", "2"]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SubscriptBox["m", "1"], " ", 
         SubscriptBox["m", "2"], " ", 
         SubsuperscriptBox["r", "0", "2"], " ", 
         SubscriptBox["r", "1"], " ", 
         SubscriptBox["r", "2"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cot", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "0"]}], "+", 
             SubscriptBox["r", "1"]}], ")"}], " ", 
           SubscriptBox["r", "2"]}], "+", 
          RowBox[{
           RowBox[{"Csc", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["m", "1"], " ", 
           SubscriptBox["r", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["r", "0"], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
              SubscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubsuperscriptBox["r", "0", "2"], " ", 
        SubscriptBox["r", "1"], " ", 
        SubscriptBox["r", "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", 
           SubscriptBox["m", "2"]], "+", 
          FractionBox[
           RowBox[{"1", "+", 
            FractionBox[
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "0"]}], 
             SubscriptBox["r", "1"]]}], 
           SubscriptBox["m", "1"]]}], ")"}]}], 
       SubsuperscriptBox["r", "0", "2"]], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           SubscriptBox["r", "1"]}], "+", 
          RowBox[{
           SubscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "0"]}], "+", 
             SubscriptBox["r", "1"]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubsuperscriptBox["r", "0", "2"], " ", 
        SubscriptBox["r", "1"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cot", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "0"]}], "+", 
             SubscriptBox["r", "1"]}], ")"}], " ", 
           SubscriptBox["r", "2"]}], "+", 
          RowBox[{
           RowBox[{"Csc", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["m", "1"], " ", 
           SubscriptBox["r", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["r", "0"], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
              SubscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubsuperscriptBox["r", "0", "2"], " ", 
        SubscriptBox["r", "1"], " ", 
        SubscriptBox["r", "2"]}]], "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], 
       RowBox[{
        SubscriptBox["m", "2"], " ", 
        SubscriptBox["r", "2"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Tau]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], 
        RowBox[{
         SubscriptBox["m", "1"], " ", 
         SubscriptBox["r", "0"]}]]}], 
      FractionBox[
       RowBox[{"Sin", "[", 
        SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], 
       RowBox[{
        SubscriptBox["m", "2"], " ", 
        SubscriptBox["r", "0"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Tau]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["m", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
               SubscriptBox["r", "0"]}], "+", 
              SubscriptBox["r", "1"]}], ")"}], " ", 
            SubscriptBox["r", "2"]}], "+", 
           RowBox[{
            SubscriptBox["m", "1"], " ", 
            SubscriptBox["r", "1"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
               SubscriptBox["r", "0"]}], "+", 
              SubscriptBox["r", "2"]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SubscriptBox["m", "1"], " ", 
         SubscriptBox["m", "2"], " ", 
         SubsuperscriptBox["r", "0", "2"], " ", 
         SubscriptBox["r", "1"], " ", 
         SubscriptBox["r", "2"]}]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", 
         SubscriptBox["m", "1"]], "+", 
        FractionBox[
         RowBox[{
          RowBox[{
           SubscriptBox["m", "2"], " ", 
           SubsuperscriptBox["r", "0", "2"]}], "+", 
          RowBox[{
           SubscriptBox["m", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["r", "0", "2"], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Cos", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
              SubscriptBox["r", "0"], " ", 
              SubscriptBox["r", "2"]}], "+", 
             SubsuperscriptBox["r", "2", "2"]}], ")"}]}]}], 
         RowBox[{
          SubscriptBox["m", "2"], " ", 
          SubscriptBox["m", "4"], " ", 
          SubsuperscriptBox["r", "2", "2"]}]]}], 
       SubsuperscriptBox["r", "0", "2"]], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Csc", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
           SubscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["r", "0"], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "1"]}]}], ")"}], " ", 
           SubscriptBox["r", "2"]}], "+", 
          RowBox[{
           RowBox[{"Cot", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
           SubscriptBox["m", "1"], " ", 
           SubscriptBox["r", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
              SubscriptBox["r", "0"]}], "+", 
             SubscriptBox["r", "2"]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubsuperscriptBox["r", "0", "2"], " ", 
        SubscriptBox["r", "1"], " ", 
        SubscriptBox["r", "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["m", "2"], " ", 
           SubscriptBox["r", "2"]}], "+", 
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
              SubscriptBox["r", "0"]}], "+", 
             SubscriptBox["r", "2"]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubsuperscriptBox["r", "0", "2"], " ", 
        SubscriptBox["r", "2"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["m", "2"], " ", 
            SubscriptBox["r", "2"]}], "+", 
           RowBox[{
            SubscriptBox["m", "1"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
               SubscriptBox["r", "0"]}], "+", 
              SubscriptBox["r", "2"]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SubscriptBox["m", "1"], " ", 
         SubscriptBox["m", "2"], " ", 
         SubsuperscriptBox["r", "0", "2"], " ", 
         SubscriptBox["r", "2"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Csc", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["m", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["r", "0"], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
               SubscriptBox["r", "1"]}]}], ")"}], " ", 
            SubscriptBox["r", "2"]}], "+", 
           RowBox[{
            RowBox[{"Cot", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["m", "1"], " ", 
            SubscriptBox["r", "1"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
               SubscriptBox["r", "0"]}], "+", 
              SubscriptBox["r", "2"]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SubscriptBox["m", "1"], " ", 
         SubscriptBox["m", "2"], " ", 
         SubsuperscriptBox["r", "0", "2"], " ", 
         SubscriptBox["r", "1"], " ", 
         SubscriptBox["r", "2"]}]]}], "0", "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Cot", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["r", "0"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Cot", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
       RowBox[{
        SubscriptBox["m", "2"], " ", 
        SubscriptBox["r", "0"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cot", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "0"]}], "+", 
             SubscriptBox["r", "1"]}], ")"}], " ", 
           SubscriptBox["r", "2"]}], "+", 
          RowBox[{
           RowBox[{"Csc", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["m", "1"], " ", 
           SubscriptBox["r", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["r", "0"], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
              SubscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubsuperscriptBox["r", "0", "2"], " ", 
        SubscriptBox["r", "1"], " ", 
        SubscriptBox["r", "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Csc", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
           SubscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["r", "0"], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "1"]}]}], ")"}], " ", 
           SubscriptBox["r", "2"]}], "+", 
          RowBox[{
           RowBox[{"Cot", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
           SubscriptBox["m", "1"], " ", 
           SubscriptBox["r", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
              SubscriptBox["r", "0"]}], "+", 
             SubscriptBox["r", "2"]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubsuperscriptBox["r", "0", "2"], " ", 
        SubscriptBox["r", "1"], " ", 
        SubscriptBox["r", "2"]}]], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Tau]", "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Csc", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "2"]}], 
          RowBox[{
           SubscriptBox["m", "3"], " ", 
           SubsuperscriptBox["r", "1", "2"]}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Csc", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Tau]", "]"}], "2"]}], 
          RowBox[{
           SubscriptBox["m", "3"], " ", 
           SubsuperscriptBox["r", "1", "2"]}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Tau]", "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Csc", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
               SubscriptBox["r", "0"]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Cot", "[", 
                  SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "-", 
                 RowBox[{"Cot", "[", 
                  SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
                ")"}], " ", 
               SubscriptBox["r", "1"]}]}], ")"}], "2"]}], 
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           SubsuperscriptBox["r", "0", "2"], " ", 
           SubsuperscriptBox["r", "1", "2"]}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Tau]", "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Csc", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
               SubscriptBox["r", "0"]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Cot", "[", 
                  SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "+", 
                 RowBox[{"Cot", "[", 
                  SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
                ")"}], " ", 
               SubscriptBox["r", "1"]}]}], ")"}], "2"]}], 
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           SubsuperscriptBox["r", "0", "2"], " ", 
           SubsuperscriptBox["r", "1", "2"]}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Tau]", "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Csc", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "2"]}], 
          RowBox[{
           SubscriptBox["m", "4"], " ", 
           SubsuperscriptBox["r", "2", "2"]}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Csc", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Tau]", "]"}], "2"]}], 
          RowBox[{
           SubscriptBox["m", "4"], " ", 
           SubsuperscriptBox["r", "2", "2"]}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Tau]", "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Csc", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
               SubscriptBox["r", "0"]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Cot", "[", 
                   SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], "+", 
                 RowBox[{"Cot", "[", 
                  SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
                ")"}], " ", 
               SubscriptBox["r", "2"]}]}], ")"}], "2"]}], 
          RowBox[{
           SubscriptBox["m", "2"], " ", 
           SubsuperscriptBox["r", "0", "2"], " ", 
           SubsuperscriptBox["r", "2", "2"]}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Tau]", "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Csc", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
               SubscriptBox["r", "0"]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Cot", "[", 
                  SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "+", 
                 RowBox[{"Cot", "[", 
                  SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
                ")"}], " ", 
               SubscriptBox["r", "2"]}]}], ")"}], "2"]}], 
          RowBox[{
           SubscriptBox["m", "2"], " ", 
           SubsuperscriptBox["r", "0", "2"], " ", 
           SubsuperscriptBox["r", "2", "2"]}]]}], ")"}]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"Cot", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "+", 
            RowBox[{"Cot", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{"Csc", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "0"]}], 
             SubscriptBox["r", "1"]]}], 
           SubscriptBox["m", "1"]], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"Csc", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
             SubscriptBox["r", "0"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cot", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "+", 
               RowBox[{"Cot", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], ")"}], 
             " ", 
             SubscriptBox["r", "2"]}]}], 
           RowBox[{
            SubscriptBox["m", "2"], " ", 
            SubscriptBox["r", "2"]}]]}], ")"}]}], 
       RowBox[{"2", " ", 
        SubsuperscriptBox["r", "0", "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cot", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], "+", 
            RowBox[{"Cot", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "-", 
            FractionBox[
             RowBox[{
              RowBox[{"Csc", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "0"]}], 
             SubscriptBox["r", "1"]]}], 
           SubscriptBox["m", "1"]], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"Csc", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
             SubscriptBox["r", "0"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Cot", "[", 
                 SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], "+", 
               RowBox[{"Cot", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], ")"}], 
             " ", 
             SubscriptBox["r", "2"]}]}], 
           RowBox[{
            SubscriptBox["m", "2"], " ", 
            SubscriptBox["r", "2"]}]]}], ")"}]}], 
       RowBox[{"2", " ", 
        SubsuperscriptBox["r", "0", "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["m", "2"]}], " ", 
         SubscriptBox["m", "3"], " ", 
         SubscriptBox["m", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Csc", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "2"], " ", 
            
            SubsuperscriptBox["r", "0", "2"]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"Cot", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            RowBox[{"Csc", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["r", "0"], " ", 
            SubscriptBox["r", "1"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cot", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "2"], 
              "-", 
              SuperscriptBox[
               RowBox[{"Cot", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "2"]}], 
             ")"}], " ", 
            SubsuperscriptBox["r", "1", "2"]}]}], ")"}], " ", 
         SubsuperscriptBox["r", "2", "2"]}], "+", 
        RowBox[{
         SubscriptBox["m", "1"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["m", "3"], " ", 
            SubscriptBox["m", "4"], " ", 
            SubsuperscriptBox["r", "1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Csc", "[", 
                 SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "2"], 
               " ", 
               SubsuperscriptBox["r", "0", "2"]}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"Cot", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
               RowBox[{"Csc", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
               SubscriptBox["r", "0"], " ", 
               SubscriptBox["r", "2"]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  SuperscriptBox[
                   RowBox[{"Cot", "[", 
                    SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], 
                   "2"]}], "+", 
                 SuperscriptBox[
                  RowBox[{"Cot", "[", 
                   SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], 
                  "2"]}], ")"}], " ", 
               SubsuperscriptBox["r", "2", "2"]}]}], ")"}]}], "+", 
           RowBox[{
            SubscriptBox["m", "2"], " ", 
            SubsuperscriptBox["r", "0", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Csc", "[", 
                 SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "2"], 
               " ", 
               SubscriptBox["m", "3"], " ", 
               SubsuperscriptBox["r", "1", "2"]}], "-", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Csc", "[", 
                 SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "2"], 
               " ", 
               SubscriptBox["m", "4"], " ", 
               SubsuperscriptBox["r", "2", "2"]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"4", " ", 
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubscriptBox["m", "3"], " ", 
        SubscriptBox["m", "4"], " ", 
        SubsuperscriptBox["r", "0", "2"], " ", 
        SubsuperscriptBox["r", "1", "2"], " ", 
        SubsuperscriptBox["r", "2", "2"]}]], "0", "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["r", "0"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
       RowBox[{
        SubscriptBox["m", "2"], " ", 
        SubscriptBox["r", "0"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", 
           SubscriptBox["m", "2"]], "+", 
          FractionBox[
           RowBox[{"1", "+", 
            FractionBox[
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "0"]}], 
             SubscriptBox["r", "1"]]}], 
           SubscriptBox["m", "1"]]}], ")"}]}], 
       SubsuperscriptBox["r", "0", "2"]], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["m", "2"], " ", 
           SubscriptBox["r", "2"]}], "+", 
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
              SubscriptBox["r", "0"]}], "+", 
             SubscriptBox["r", "2"]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubsuperscriptBox["r", "0", "2"], " ", 
        SubscriptBox["r", "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"Cot", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "+", 
            RowBox[{"Cot", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{"Csc", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "0"]}], 
             SubscriptBox["r", "1"]]}], 
           SubscriptBox["m", "1"]], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"Csc", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
             SubscriptBox["r", "0"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cot", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "+", 
               RowBox[{"Cot", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], ")"}], 
             " ", 
             SubscriptBox["r", "2"]}]}], 
           RowBox[{
            SubscriptBox["m", "2"], " ", 
            SubscriptBox["r", "2"]}]]}], ")"}]}], 
       RowBox[{"2", " ", 
        SubsuperscriptBox["r", "0", "2"]}]], 
      FractionBox[
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubsuperscriptBox["r", "0", "2"]}]], "0", 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cot", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], "+", 
            RowBox[{"Cot", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "-", 
            FractionBox[
             RowBox[{
              RowBox[{"Csc", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "0"]}], 
             SubscriptBox["r", "1"]]}], 
           SubscriptBox["m", "1"]], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"Csc", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
             SubscriptBox["r", "0"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Cot", "[", 
                 SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], "+", 
               RowBox[{"Cot", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], ")"}], 
             " ", 
             SubscriptBox["r", "2"]}]}], 
           RowBox[{
            SubscriptBox["m", "2"], " ", 
            SubscriptBox["r", "2"]}]]}], ")"}]}], 
       RowBox[{"2", " ", 
        SubsuperscriptBox["r", "0", "2"]}]], "0", "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["r", "0"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
        RowBox[{
         SubscriptBox["m", "2"], " ", 
         SubscriptBox["r", "0"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           SubscriptBox["r", "1"]}], "+", 
          RowBox[{
           SubscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "0"]}], "+", 
             SubscriptBox["r", "1"]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubsuperscriptBox["r", "0", "2"], " ", 
        SubscriptBox["r", "1"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["m", "2"], " ", 
            SubscriptBox["r", "2"]}], "+", 
           RowBox[{
            SubscriptBox["m", "1"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
               SubscriptBox["r", "0"]}], "+", 
              SubscriptBox["r", "2"]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SubscriptBox["m", "1"], " ", 
         SubscriptBox["m", "2"], " ", 
         SubsuperscriptBox["r", "0", "2"], " ", 
         SubscriptBox["r", "2"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cot", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], "+", 
            RowBox[{"Cot", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "-", 
            FractionBox[
             RowBox[{
              RowBox[{"Csc", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "0"]}], 
             SubscriptBox["r", "1"]]}], 
           SubscriptBox["m", "1"]], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"Csc", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
             SubscriptBox["r", "0"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Cot", "[", 
                 SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], "+", 
               RowBox[{"Cot", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], ")"}], 
             " ", 
             SubscriptBox["r", "2"]}]}], 
           RowBox[{
            SubscriptBox["m", "2"], " ", 
            SubscriptBox["r", "2"]}]]}], ")"}]}], 
       RowBox[{"2", " ", 
        SubsuperscriptBox["r", "0", "2"]}]], "0", 
      FractionBox[
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubsuperscriptBox["r", "0", "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"Cot", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "+", 
            RowBox[{"Cot", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{"Csc", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "0"]}], 
             SubscriptBox["r", "1"]]}], 
           SubscriptBox["m", "1"]], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"Csc", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
             SubscriptBox["r", "0"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cot", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "+", 
               RowBox[{"Cot", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], ")"}], 
             " ", 
             SubscriptBox["r", "2"]}]}], 
           RowBox[{
            SubscriptBox["m", "2"], " ", 
            SubscriptBox["r", "2"]}]]}], ")"}]}], 
       RowBox[{"2", " ", 
        SubsuperscriptBox["r", "0", "2"]}]], "0", "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Cot", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["r", "0"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Cot", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
         RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
        RowBox[{
         SubscriptBox["m", "2"], " ", 
         SubscriptBox["r", "0"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cot", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "0"]}], "+", 
             SubscriptBox["r", "1"]}], ")"}], " ", 
           SubscriptBox["r", "2"]}], "+", 
          RowBox[{
           RowBox[{"Csc", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SubscriptBox["m", "1"], " ", 
           SubscriptBox["r", "1"], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["r", "0"], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
              SubscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubsuperscriptBox["r", "0", "2"], " ", 
        SubscriptBox["r", "1"], " ", 
        SubscriptBox["r", "2"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Csc", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["m", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["r", "0"], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
               SubscriptBox["r", "1"]}]}], ")"}], " ", 
            SubscriptBox["r", "2"]}], "+", 
           RowBox[{
            RowBox[{"Cot", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["m", "1"], " ", 
            SubscriptBox["r", "1"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
               SubscriptBox["r", "0"]}], "+", 
              SubscriptBox["r", "2"]}], ")"}]}]}], ")"}]}], 
        RowBox[{
         SubscriptBox["m", "1"], " ", 
         SubscriptBox["m", "2"], " ", 
         SubsuperscriptBox["r", "0", "2"], " ", 
         SubscriptBox["r", "1"], " ", 
         SubscriptBox["r", "2"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["m", "2"]}], " ", 
         SubscriptBox["m", "3"], " ", 
         SubscriptBox["m", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Csc", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "2"], " ", 
            
            SubsuperscriptBox["r", "0", "2"]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"Cot", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            RowBox[{"Csc", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
            SubscriptBox["r", "0"], " ", 
            SubscriptBox["r", "1"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"Cot", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "2"], 
              "-", 
              SuperscriptBox[
               RowBox[{"Cot", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "2"]}], 
             ")"}], " ", 
            SubsuperscriptBox["r", "1", "2"]}]}], ")"}], " ", 
         SubsuperscriptBox["r", "2", "2"]}], "+", 
        RowBox[{
         SubscriptBox["m", "1"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["m", "3"], " ", 
            SubscriptBox["m", "4"], " ", 
            SubsuperscriptBox["r", "1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Csc", "[", 
                 SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "2"], 
               " ", 
               SubsuperscriptBox["r", "0", "2"]}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"Cot", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
               RowBox[{"Csc", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
               SubscriptBox["r", "0"], " ", 
               SubscriptBox["r", "2"]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  SuperscriptBox[
                   RowBox[{"Cot", "[", 
                    SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], 
                   "2"]}], "+", 
                 SuperscriptBox[
                  RowBox[{"Cot", "[", 
                   SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], 
                  "2"]}], ")"}], " ", 
               SubsuperscriptBox["r", "2", "2"]}]}], ")"}]}], "+", 
           RowBox[{
            SubscriptBox["m", "2"], " ", 
            SubsuperscriptBox["r", "0", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"Csc", "[", 
                 SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "2"], 
               " ", 
               SubscriptBox["m", "3"], " ", 
               SubsuperscriptBox["r", "1", "2"]}], "-", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Csc", "[", 
                 SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "2"], 
               " ", 
               SubscriptBox["m", "4"], " ", 
               SubsuperscriptBox["r", "2", "2"]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{"4", " ", 
        SubscriptBox["m", "1"], " ", 
        SubscriptBox["m", "2"], " ", 
        SubscriptBox["m", "3"], " ", 
        SubscriptBox["m", "4"], " ", 
        SubsuperscriptBox["r", "0", "2"], " ", 
        SubsuperscriptBox["r", "1", "2"], " ", 
        SubsuperscriptBox["r", "2", "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cot", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], "+", 
            RowBox[{"Cot", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "-", 
            FractionBox[
             RowBox[{
              RowBox[{"Csc", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "0"]}], 
             SubscriptBox["r", "1"]]}], 
           SubscriptBox["m", "1"]], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"Csc", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
             SubscriptBox["r", "0"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Cot", "[", 
                 SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], "+", 
               RowBox[{"Cot", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], ")"}], 
             " ", 
             SubscriptBox["r", "2"]}]}], 
           RowBox[{
            SubscriptBox["m", "2"], " ", 
            SubscriptBox["r", "2"]}]]}], ")"}]}], 
       RowBox[{"2", " ", 
        SubsuperscriptBox["r", "0", "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"Sin", "[", "\[Tau]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"Cot", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "+", 
            RowBox[{"Cot", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{"Csc", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
              SubscriptBox["r", "0"]}], 
             SubscriptBox["r", "1"]]}], 
           SubscriptBox["m", "1"]], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"Csc", "[", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
             SubscriptBox["r", "0"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cot", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "+", 
               RowBox[{"Cot", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], ")"}], 
             " ", 
             SubscriptBox["r", "2"]}]}], 
           RowBox[{
            SubscriptBox["m", "2"], " ", 
            SubscriptBox["r", "2"]}]]}], ")"}]}], 
       RowBox[{"2", " ", 
        SubsuperscriptBox["r", "0", "2"]}]], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Tau]", "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Csc", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "2"]}], 
          RowBox[{
           SubscriptBox["m", "3"], " ", 
           SubsuperscriptBox["r", "1", "2"]}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Csc", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Tau]", "]"}], "2"]}], 
          RowBox[{
           SubscriptBox["m", "3"], " ", 
           SubsuperscriptBox["r", "1", "2"]}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Tau]", "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Csc", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
               SubscriptBox["r", "0"]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Cot", "[", 
                  SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "-", 
                 RowBox[{"Cot", "[", 
                  SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
                ")"}], " ", 
               SubscriptBox["r", "1"]}]}], ")"}], "2"]}], 
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           SubsuperscriptBox["r", "0", "2"], " ", 
           SubsuperscriptBox["r", "1", "2"]}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Tau]", "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Csc", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
               SubscriptBox["r", "0"]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Cot", "[", 
                  SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "+", 
                 RowBox[{"Cot", "[", 
                  SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
                ")"}], " ", 
               SubscriptBox["r", "1"]}]}], ")"}], "2"]}], 
          RowBox[{
           SubscriptBox["m", "1"], " ", 
           SubsuperscriptBox["r", "0", "2"], " ", 
           SubsuperscriptBox["r", "1", "2"]}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Tau]", "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Csc", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "2"]}], 
          RowBox[{
           SubscriptBox["m", "4"], " ", 
           SubsuperscriptBox["r", "2", "2"]}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Csc", "[", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Tau]", "]"}], "2"]}], 
          RowBox[{
           SubscriptBox["m", "4"], " ", 
           SubsuperscriptBox["r", "2", "2"]}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Tau]", "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Csc", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
               SubscriptBox["r", "0"]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Cot", "[", 
                   SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], "+", 
                 RowBox[{"Cot", "[", 
                  SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
                ")"}], " ", 
               SubscriptBox["r", "2"]}]}], ")"}], "2"]}], 
          RowBox[{
           SubscriptBox["m", "2"], " ", 
           SubsuperscriptBox["r", "0", "2"], " ", 
           SubsuperscriptBox["r", "2", "2"]}]], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Tau]", "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Csc", "[", 
                SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
               SubscriptBox["r", "0"]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Cot", "[", 
                  SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "+", 
                 RowBox[{"Cot", "[", 
                  SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], 
                ")"}], " ", 
               SubscriptBox["r", "2"]}]}], ")"}], "2"]}], 
          RowBox[{
           SubscriptBox["m", "2"], " ", 
           SubsuperscriptBox["r", "0", "2"], " ", 
           SubsuperscriptBox["r", "2", "2"]}]]}], ")"}]}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["1", 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["1", 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["1", 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"], "+", 
        SubscriptBox["m", "3"], "+", 
        SubscriptBox["m", "4"]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7304575754986353`*^9, 3.730457630431779*^9, 
  3.730458872286943*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pseudo Potential", "Section",
 CellChangeTimes->{{3.730457645274672*^9, 3.730457651914208*^9}}],

Cell[CellGroupData[{

Cell["Construct SmatR and SmatV", "Subsection",
 CellChangeTimes->{{3.73045766169948*^9, 3.7304576695711927`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"smatR", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "natoms", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"smatV", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"ncoords", ",", "natoms", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"icoord", "=", "1"}], ",", 
    RowBox[{"icoord", "\[LessEqual]", "3"}], ",", 
    RowBox[{"icoord", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xatom", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"x", "=", "1"}], ",", 
       RowBox[{"x", "\[LessEqual]", "3"}], ",", 
       RowBox[{"x", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"atom", "=", "1"}], ",", 
         RowBox[{"atom", "\[LessEqual]", "natoms"}], ",", 
         RowBox[{"atom", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xatom", "++"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"smatR", "[", 
            RowBox[{"[", 
             RowBox[{"icoord", ",", "atom", ",", "x"}], "]"}], "]"}], "=", 
           RowBox[{"smat", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"icoord", "+", "ncoords"}], ",", "xatom"}], "]"}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"icoord", "=", "1"}], ",", 
   RowBox[{"icoord", "\[LessEqual]", "ncoords"}], ",", 
   RowBox[{"icoord", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xatom", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"x", "=", "1"}], ",", 
      RowBox[{"x", "\[LessEqual]", "3"}], ",", 
      RowBox[{"x", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"atom", "=", "1"}], ",", 
        RowBox[{"atom", "\[LessEqual]", "natoms"}], ",", 
        RowBox[{"atom", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"xatom", "++"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"smatV", "[", 
           RowBox[{"[", 
            RowBox[{"icoord", ",", "atom", ",", "x"}], "]"}], "]"}], "=", 
          RowBox[{"smat", "[", 
           RowBox[{"[", 
            RowBox[{"icoord", ",", "xatom"}], "]"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.653719518430284*^9, 3.6537195616772423`*^9}, {
   3.653719604703287*^9, 3.6537197011522503`*^9}, {3.65371974246064*^9, 
   3.6537198267860937`*^9}, {3.653719861865653*^9, 3.65371992471642*^9}, {
   3.653719979472892*^9, 3.653720326410861*^9}, {3.653720369875613*^9, 
   3.653720459112726*^9}, {3.653720600844058*^9, 3.6537206017203197`*^9}, {
   3.6537207810629253`*^9, 3.6537207873701067`*^9}, 3.687786200981303*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
U1 part of the pseudo potential\
\>", "Subsection",
 CellChangeTimes->{{3.730457702612557*^9, 3.7304577166593637`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"u1", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"iatom", "=", "1"}], ",", 
   RowBox[{"iatom", "\[LessEqual]", "natoms"}], ",", 
   RowBox[{"iatom", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u0", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"ia", "=", "1"}], ",", 
      RowBox[{"ia", "\[LessEqual]", "3"}], ",", 
      RowBox[{"ia", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"ib", "=", "1"}], ",", 
        RowBox[{"ib", "\[LessEqual]", "3"}], ",", 
        RowBox[{"ib", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"ig", "=", "1"}], ",", 
          RowBox[{"ig", "\[LessEqual]", "3"}], ",", 
          RowBox[{"ig", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"ib2", "=", "1"}], ",", 
            RowBox[{"ib2", "\[LessEqual]", "3"}], ",", 
            RowBox[{"ib2", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"ig2", "=", "1"}], ",", 
              RowBox[{"ig2", "\[LessEqual]", "3"}], ",", 
              RowBox[{"ig2", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"u0", "=", 
               RowBox[{"u0", "+", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Normal", "[", 
                   RowBox[{"LeviCivitaTensor", "[", "3", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"ia", ",", "ib", ",", "ig"}], "]"}], "]"}], "*", 
                 RowBox[{
                  RowBox[{"Normal", "[", 
                   RowBox[{"LeviCivitaTensor", "[", "3", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"ia", ",", "ib2", ",", "ig2"}], "]"}], "]"}], "*", 
                 
                 RowBox[{"smatR", "[", 
                  RowBox[{"[", 
                   RowBox[{"ib", ",", "iatom", ",", "ig"}], "]"}], "]"}], "*", 
                 RowBox[{"smatR", "[", 
                  RowBox[{"[", 
                   RowBox[{"ib2", ",", "iatom", ",", "ig2"}], "]"}], 
                  "]"}]}]}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], 
         "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"u1", "=", 
     RowBox[{"u1", "+", 
      RowBox[{"u0", "/", 
       RowBox[{"mass", "[", 
        RowBox[{"[", "iatom", "]"}], "]"}]}]}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.653719518430284*^9, 3.6537195616772423`*^9}, {
  3.653719604703287*^9, 3.6537197011522503`*^9}, {3.65371974246064*^9, 
  3.6537198267860937`*^9}, {3.653719861865653*^9, 3.65371992471642*^9}, {
  3.653719979472892*^9, 3.653720326410861*^9}, {3.653720369875613*^9, 
  3.653720459112726*^9}, {3.653720600844058*^9, 3.6537206017203197`*^9}, {
  3.6537207810629253`*^9, 3.6537207873701067`*^9}, {3.687786200981303*^9, 
  3.687786203312639*^9}, {3.730457679456579*^9, 3.730457680070629*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
U2 part of the pseudo potential\
\>", "Subsection",
 CellChangeTimes->{{3.730457730836216*^9, 3.730457736228063*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"u2", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"iatom", "=", "1"}], ",", 
   RowBox[{"iatom", "\[LessEqual]", "natoms"}], ",", 
   RowBox[{"iatom", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u0", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"ia", "=", "1"}], ",", 
      RowBox[{"ia", "\[LessEqual]", "3"}], ",", 
      RowBox[{"ia", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"ib", "=", "1"}], ",", 
        RowBox[{"ib", "\[LessEqual]", "3"}], ",", 
        RowBox[{"ib", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"ig", "=", "1"}], ",", 
          RowBox[{"ig", "\[LessEqual]", "3"}], ",", 
          RowBox[{"ig", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"n", "=", "1"}], ",", 
            RowBox[{"n", "\[LessEqual]", "ncoords"}], ",", 
            RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"u0", "=", 
             RowBox[{"u0", "+", 
              RowBox[{
               RowBox[{
                RowBox[{"Normal", "[", 
                 RowBox[{"LeviCivitaTensor", "[", "3", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"ia", ",", "ib", ",", "ig"}], "]"}], "]"}], "*", 
               RowBox[{"smatV", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "iatom", ",", "ig"}], "]"}], "]"}], "*", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"smatR", "[", 
                  RowBox[{"[", 
                   RowBox[{"ib", ",", "iatom", ",", "ia"}], "]"}], "]"}], ",", 
                 RowBox[{"coords", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}]}]}]}], 
           "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"u2", "=", 
     RowBox[{"u2", "+", 
      RowBox[{"u0", "/", 
       RowBox[{"mass", "[", 
        RowBox[{"[", "iatom", "]"}], "]"}]}]}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.653719518430284*^9, 3.6537195616772423`*^9}, {
  3.653719604703287*^9, 3.6537197011522503`*^9}, {3.65371974246064*^9, 
  3.6537198267860937`*^9}, {3.653719861865653*^9, 3.65371992471642*^9}, {
  3.653719979472892*^9, 3.653720326410861*^9}, {3.653720369875613*^9, 
  3.653720459112726*^9}, {3.653720600844058*^9, 3.6537206017203197`*^9}, {
  3.6537207810629253`*^9, 3.6537207873701067`*^9}, {3.687786200981303*^9, 
  3.687786205372591*^9}, {3.730457720870145*^9, 3.7304577213598623`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
U3 part of the pseudo potential\
\>", "Subsection",
 CellChangeTimes->{{3.730457758133759*^9, 3.730457760796361*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"u3", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"iatom", "=", "1"}], ",", 
   RowBox[{"iatom", "\[LessEqual]", "natoms"}], ",", 
   RowBox[{"iatom", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u0", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"ia", "=", "1"}], ",", 
      RowBox[{"ia", "\[LessEqual]", "3"}], ",", 
      RowBox[{"ia", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"n", "=", "1"}], ",", 
        RowBox[{"n", "\[LessEqual]", "ncoords"}], ",", 
        RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"m", "=", "1"}], ",", 
          RowBox[{"m", "\[LessEqual]", "ncoords"}], ",", 
          RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"u0", "=", 
           RowBox[{"u0", "+", 
            RowBox[{
             RowBox[{"smatV", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "iatom", ",", "ia"}], "]"}], "]"}], "*", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"smatV", "[", 
                RowBox[{"[", 
                 RowBox[{"m", ",", "iatom", ",", "ia"}], "]"}], "]"}], ",", 
               RowBox[{"coords", "[", 
                RowBox[{"[", "n", "]"}], "]"}], ",", 
               RowBox[{"coords", "[", 
                RowBox[{"[", "m", "]"}], "]"}]}], "]"}]}]}]}]}], 
         "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"u3", "=", 
     RowBox[{"u3", "+", 
      RowBox[{"u0", "/", 
       RowBox[{"mass", "[", 
        RowBox[{"[", "iatom", "]"}], "]"}]}]}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.653719518430284*^9, 3.6537195616772423`*^9}, {
  3.653719604703287*^9, 3.6537197011522503`*^9}, {3.65371974246064*^9, 
  3.6537198267860937`*^9}, {3.653719861865653*^9, 3.65371992471642*^9}, {
  3.653719979472892*^9, 3.653720326410861*^9}, {3.653720369875613*^9, 
  3.653720459112726*^9}, {3.653720600844058*^9, 3.6537206017203197`*^9}, {
  3.6537207810629253`*^9, 3.6537207873701067`*^9}, {3.687786200981303*^9, 
  3.68778620785343*^9}, {3.730457750330349*^9, 3.7304577506082563`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
U4 part of the pseudo potential and print\
\>", "Subsection",
 CellChangeTimes->{{3.730457776326243*^9, 3.730457786444726*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"u4", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"iatom", "=", "1"}], ",", 
    RowBox[{"iatom", "\[LessEqual]", "natoms"}], ",", 
    RowBox[{"iatom", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"u0", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"ia", "=", "1"}], ",", 
       RowBox[{"ia", "\[LessEqual]", "3"}], ",", 
       RowBox[{"ia", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"n", "=", "1"}], ",", 
         RowBox[{"n", "\[LessEqual]", "ncoords"}], ",", 
         RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"m", "=", "1"}], ",", 
           RowBox[{"m", "\[LessEqual]", "ncoords"}], ",", 
           RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"u0", "=", 
            RowBox[{"u0", "+", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"smatV", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "iatom", ",", "ia"}], "]"}], "]"}], ",", 
                RowBox[{"coords", "[", 
                 RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "*", 
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"smatV", "[", 
                 RowBox[{"[", 
                  RowBox[{"m", ",", "iatom", ",", "ia"}], "]"}], "]"}], ",", 
                RowBox[{"coords", "[", 
                 RowBox[{"[", "m", "]"}], "]"}]}], "]"}]}]}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u4", "=", 
      RowBox[{"u4", "+", 
       RowBox[{"u0", "/", 
        RowBox[{"mass", "[", 
         RowBox[{"[", "iatom", "]"}], "]"}]}]}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pseudo", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", "u1"}], "+", "u2", "-", "u3", "-", 
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", "u4"}]}], ")"}], "/", "4"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"pseudo", "=", 
  RowBox[{"pseudo", "//", "Simplify"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.653719518430284*^9, 3.6537195616772423`*^9}, {
  3.653719604703287*^9, 3.6537197011522503`*^9}, {3.65371974246064*^9, 
  3.6537198267860937`*^9}, {3.653719861865653*^9, 3.65371992471642*^9}, {
  3.653719979472892*^9, 3.653720326410861*^9}, {3.653720369875613*^9, 
  3.653720459112726*^9}, {3.653720600844058*^9, 3.6537206017203197`*^9}, {
  3.6537207810629253`*^9, 3.6537207873701067`*^9}, {3.687786200981303*^9, 
  3.6877862111791353`*^9}, {3.730457768496251*^9, 3.7304577959339247`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"16", " ", 
    SubscriptBox["7", "1"], " ", 
    SubscriptBox["7", "2"], " ", 
    SubscriptBox["7", "3"], " ", 
    SubscriptBox["7", "4"], " ", 
    SubsuperscriptBox["r", "0", "2"], " ", 
    SubsuperscriptBox["r", "1", "2"], " ", 
    SubsuperscriptBox["r", "2", "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"8", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Tau]"}], "]"}], " ", 
        RowBox[{"Cot", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
        RowBox[{"Cot", "[", 
         SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"6", "-", 
          RowBox[{"4", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "1"]}], "]"}]}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "-", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"]}], ")"}]}], "]"}], 
          "-", 
          RowBox[{"4", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             SubscriptBox["\[CapitalDelta]\[Alpha]", "2"]}], "]"}]}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "+", 
              SubscriptBox["\[CapitalDelta]\[Alpha]", "2"]}], ")"}]}], 
           "]"}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Csc", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Csc", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "2"]}]}], 
      ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["7", "1"], "+", 
       SubscriptBox["7", "2"]}], ")"}], " ", 
     SubscriptBox["7", "3"], " ", 
     SubscriptBox["7", "4"], " ", 
     SubsuperscriptBox["r", "1", "2"], " ", 
     SubsuperscriptBox["r", "2", "2"]}], "+", 
    RowBox[{"4", " ", 
     SubscriptBox["7", "3"], " ", 
     SubscriptBox["7", "4"], " ", 
     SubscriptBox["r", "0"], " ", 
     SubscriptBox["r", "1"], " ", 
     SubscriptBox["r", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "-", 
          RowBox[{
           RowBox[{"Cot", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           RowBox[{"Csc", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cot", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
           RowBox[{"Csc", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Tau]", "]"}], "2"]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Tau]", "]"}], "2"], " ", 
           RowBox[{"Cot", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"Csc", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "2"]}], 
            ")"}], " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cot", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Tau]", "]"}], "2"], " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}]}], ")"}], 
        " ", 
        SubscriptBox["7", "1"], " ", 
        SubscriptBox["r", "1"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "-", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"Cot", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Tau]"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", 
                  SubscriptBox["\[CapitalDelta]\[Alpha]", "1"]}], "]"}]}], 
               ")"}], " ", 
              RowBox[{"Cot", "[", 
               SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}]}]}], ")"}],
            " ", 
           RowBox[{"Csc", "[", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}]}]}], ")"}], 
        " ", 
        SubscriptBox["7", "2"], " ", 
        SubscriptBox["r", "2"]}]}], ")"}]}], "-", 
    RowBox[{"2", " ", 
     SubsuperscriptBox["r", "0", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "2"]}], "]"}]}], ")"}], 
        " ", 
        SuperscriptBox[
         RowBox[{"Csc", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "2"], "]"}], "2"], " ", 
        SubscriptBox["7", "1"], " ", 
        SubscriptBox["7", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["7", "2"], "+", 
          SubscriptBox["7", "4"]}], ")"}], " ", 
        SubsuperscriptBox["r", "1", "2"]}], "-", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            SubscriptBox["\[CapitalDelta]\[Alpha]", "1"]}], "]"}]}], ")"}], 
        " ", 
        SuperscriptBox[
         RowBox[{"Csc", "[", 
          SubscriptBox["\[CapitalDelta]\[Alpha]", "1"], "]"}], "2"], " ", 
        SubscriptBox["7", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["7", "1"], "+", 
          SubscriptBox["7", "3"]}], ")"}], " ", 
        SubscriptBox["7", "4"], " ", 
        SubsuperscriptBox["r", "2", "2"]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.73045779772645*^9, 3.730458878791699*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Replace with mass and equilibrium coordinate values\
\>", "Section",
 CellChangeTimes->{{3.730457807351285*^9, 3.7304578274307327`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Update", " ", "this", " ", "if", " ", "different", " ", "coordinates", 
    " ", "are", " ", "used"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"coordsEQ", "=", 
     RowBox[{"{", 
      RowBox[{
      "1.200000000000000", ",", "1.060000000000000", ",", "1.060000000000000",
        ",", "0.000000000000000", ",", "0.000000000000000", ",", 
       "0.000000000000000"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Below", " ", "for", " ", "HCCH"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"repl", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["m", "1"], "\[Rule]", "12.00000000000000"}], ",", 
       RowBox[{
        SubscriptBox["m", "2"], "\[Rule]", "12.00000000000000"}], ",", 
       RowBox[{
        SubscriptBox["m", "3"], "\[Rule]", "1.007825050000000"}], ",", 
       RowBox[{
        SubscriptBox["m", "4"], "\[Rule]", "1.007825050000000"}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6537205739147367`*^9, 3.653720621875736*^9}, {
   3.653721072969656*^9, 3.6537211069578*^9}, {3.687701102452917*^9, 
   3.687701115206724*^9}, 3.687786218062606*^9, {3.730457857436751*^9, 
   3.730457875643737*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Expand and print out the KEO G-matrix elements\
\>", "Section",
 CellChangeTimes->{{3.730457915705803*^9, 3.730457926593399*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fstring", "=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<C2H2_KEO_GMAT_\>\"", "<>", 
     RowBox[{"ToString", "[", "nccords", "]"}], "<>", "\"\<_coords_\>\"", "<>", 
     RowBox[{"ToString", "[", "natoms", "]"}], "<>", "\"\<atoms_\>\"", "<>", 
     RowBox[{"ToString", "[", "maxorderGMAT", "]"}], "<>", 
     "\"\<_order_\>\""}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sfile", "=", 
    RowBox[{"OpenWrite", "[", 
     RowBox[{"\"\<~/Desktop/\>\"", "<>", "fstring", "<>", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"ToString", "/@", 
         RowBox[{
          RowBox[{"Date", "[", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{";;", "3"}], "]"}], "]"}]}], ",", "\"\<-\>\""}], "]"}], 
      "<>", "\"\<.dat\>\""}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"lambda", "=", "1"}], ",", 
   RowBox[{"lambda", "\[LessEqual]", 
    RowBox[{"natoms", "*", "3"}]}], ",", 
   RowBox[{"lambda", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"mu", "=", "1"}], ",", 
     RowBox[{"mu", "\[LessEqual]", 
      RowBox[{"natoms", "*", "3"}]}], ",", 
     RowBox[{"mu", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i1", "=", "0"}], ",", 
       RowBox[{"i1", "\[LessEqual]", "maxorderGMAT"}], ",", 
       RowBox[{"i1", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i2", "=", "0"}], ",", 
         RowBox[{"i2", "\[LessEqual]", "maxorderGMAT"}], ",", 
         RowBox[{"i2", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i3", "=", "0"}], ",", 
           RowBox[{"i3", "\[LessEqual]", "maxorderGMAT"}], ",", 
           RowBox[{"i3", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i4", "=", 
              RowBox[{"-", "2"}]}], ",", 
             RowBox[{"i4", "\[LessEqual]", "maxorderGMAT"}], ",", 
             RowBox[{"i4", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i5", "=", 
                RowBox[{"-", "2"}]}], ",", 
               RowBox[{"i5", "\[LessEqual]", "maxorderGMAT"}], ",", 
               RowBox[{"i5", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"i6", "=", "0"}], ",", 
                 RowBox[{"i6", "\[LessEqual]", "maxorderGMAT"}], ",", 
                 RowBox[{"i6", "++"}], ",", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    "i1", "+", "i2", "+", "i3", "+", "i4", "+", "i5", "+", 
                    "i6"}], ")"}], "\[GreaterEqual]", "maxorderGMAT"}], "||", 
                    
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i4", "+", "i5"}], ")"}], "<", 
                    RowBox[{"-", "2"}]}]}], ",", 
                    RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"coef", "=", 
                   RowBox[{
                    RowBox[{"SeriesCoefficient", "[", 
                    RowBox[{
                    RowBox[{"gmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"lambda", ",", "mu"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"coordsEQ", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "i1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"coordsEQ", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "i2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"coordsEQ", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "i3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"coordsEQ", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", "i4"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], ",", 
                    RowBox[{"coordsEQ", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], ",", "i5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "6", "]"}], "]"}], ",", 
                    RowBox[{"coordsEQ", "[", 
                    RowBox[{"[", "6", "]"}], "]"}], ",", "i6"}], "}"}]}], 
                    "]"}], "/.", "repl"}]}], ";", "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", "coef", "]"}], ">", 
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "14"}], ")"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"WriteString", "[", 
                    RowBox[{
                    "sfile", ",", "lambda", ",", "\"\< \>\"", ",", "mu", ",", 
                    "\"\<   \>\"", ",", "i1", ",", "\"\< \>\"", ",", "i2", 
                    ",", "\"\< \>\"", ",", "i3", ",", "\"\< \>\"", ",", "i4", 
                    ",", "\"\< \>\"", ",", "i5", ",", "\"\< \>\"", ",", "i6", 
                    ",", "\"\<    \>\"", ",", 
                    RowBox[{"coef", "//", "FortranForm"}], ",", 
                    "\"\<\\n\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
                   "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
                "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Close", "[", "sfile", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6537205739147367`*^9, 3.653720621875736*^9}, {
  3.653721072969656*^9, 3.6537211069578*^9}, {3.687701102452917*^9, 
  3.687701115206724*^9}, {3.687786218062606*^9, 3.687786221731748*^9}, {
  3.6877864946565857`*^9, 3.6877864950491657`*^9}, {3.730457941354371*^9, 
  3.730457974676607*^9}, {3.730458007456257*^9, 3.730458017951022*^9}}],

Cell[BoxData["\<\"/home/kchubb/Desktop/C2H2_KEO_GMAT_nccords_coords_4atoms_6_\
order_2018-3-19.dat\"\>"], "Output",
 CellChangeTimes->{3.6877865017868834`*^9, 3.730459640421145*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Expand and print out the KEO Pseudo Potential elements\
\>", "Section",
 CellChangeTimes->{3.730458152963523*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fstring", "=", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<C2H2_KEO_PSEUDO_\>\"", "<>", 
     RowBox[{"ToString", "[", "ncoords", "]"}], "<>", "\"\<_coords_\>\"", "<>", 
     RowBox[{"ToString", "[", "natoms", "]"}], "<>", "\"\<atoms_\>\"", "<>", 
     RowBox[{"ToString", "[", "maxorderPSEUDO", "]"}], "<>", 
     "\"\<_order_\>\""}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sfile", "=", 
    RowBox[{"OpenWrite", "[", 
     RowBox[{"\"\<~/Desktop/\>\"", "<>", "fstring", "<>", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"ToString", "/@", 
         RowBox[{
          RowBox[{"Date", "[", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{";;", "3"}], "]"}], "]"}]}], ",", "\"\<-\>\""}], "]"}], 
      "<>", "\"\<.dat\>\""}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i1", "=", "0"}], ",", 
   RowBox[{"i1", "\[LessEqual]", "maxorderPSEUDO"}], ",", 
   RowBox[{"i1", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i2", "=", "0"}], ",", 
     RowBox[{"i2", "\[LessEqual]", "maxorderPSEUDO"}], ",", 
     RowBox[{"i2", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i3", "=", "0"}], ",", 
       RowBox[{"i3", "\[LessEqual]", "maxorderPSEUDO"}], ",", 
       RowBox[{"i3", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i4", "=", 
          RowBox[{"-", "2"}]}], ",", 
         RowBox[{"i4", "\[LessEqual]", "maxorderPSEUDO"}], ",", 
         RowBox[{"i4", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i5", "=", 
            RowBox[{"-", "2"}]}], ",", 
           RowBox[{"i5", "\[LessEqual]", "maxorderPSEUDO"}], ",", 
           RowBox[{"i5", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i6", "=", "0"}], ",", 
             RowBox[{"i6", "\[LessEqual]", "maxorderPSEUDO"}], ",", 
             RowBox[{"i6", "++"}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                   "i1", "+", "i2", "+", "i3", "+", "i4", "+", "i5", "+", 
                    "i6"}], ")"}], "\[GreaterEqual]", "maxorderPSEUDO"}], "||", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"i4", "+", "i5"}], ")"}], "<", 
                  RowBox[{"-", "2"}]}]}], ",", 
                RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"coef", "=", 
               RowBox[{
                RowBox[{"SeriesCoefficient", "[", 
                 RowBox[{"pseudo", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"coordsEQ", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "i1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"coordsEQ", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "i2"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"coordsEQ", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "i3"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"coordsEQ", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", "i4"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], ",", 
                    RowBox[{"coordsEQ", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], ",", "i5"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"coords", "[", 
                    RowBox[{"[", "6", "]"}], "]"}], ",", 
                    RowBox[{"coordsEQ", "[", 
                    RowBox[{"[", "6", "]"}], "]"}], ",", "i6"}], "}"}]}], 
                 "]"}], "/.", "repl"}]}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", "coef", "]"}], ">", 
                 RowBox[{"10", "^", 
                  RowBox[{"(", 
                   RowBox[{"-", "14"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"WriteString", "[", 
                  RowBox[{
                  "sfile", ",", "i1", ",", "\"\< \>\"", ",", "i2", ",", 
                   "\"\< \>\"", ",", "i3", ",", "\"\< \>\"", ",", "i4", ",", 
                   "\"\< \>\"", ",", "i5", ",", "\"\< \>\"", ",", "i6", ",", 
                   "\"\<    \>\"", ",", 
                   RowBox[{"coef", "//", "FortranForm"}], ",", 
                   "\"\<\\n\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
               "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "sfile", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6537205739147367`*^9, 3.653720621875736*^9}, {
  3.653721072969656*^9, 3.6537211069578*^9}, {3.687701102452917*^9, 
  3.687701115206724*^9}, {3.687786218062606*^9, 3.687786221731748*^9}, {
  3.687786497875896*^9, 3.687786498300742*^9}, {3.73045812327253*^9, 
  3.7304581340289583`*^9}}],

Cell[BoxData["\<\"/home/kchubb/Desktop/C2H2_KEO_PSEUDO_6_coords_4atoms_6_\
order_2018-3-19.dat\"\>"], "Output",
 CellChangeTimes->{3.653720501563224*^9, 3.65372062931041*^9, 
  3.653721336200301*^9, 3.6878622430444403`*^9, 3.7304598010057383`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1369, 911},
WindowMargins->{{208, Automatic}, {Automatic, 3}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (January 25, 2013)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 167, 4, 91, "Title"],
Cell[CellGroupData[{
Cell[772, 30, 156, 2, 83, "Section"],
Cell[931, 34, 4780, 65, 41, "Input"],
Cell[5714, 101, 6565, 113, 262, "Input"],
Cell[CellGroupData[{
Cell[12304, 218, 134, 3, 33, "Subsection"],
Cell[CellGroupData[{
Cell[12463, 225, 7090, 131, 240, "Input"],
Cell[19556, 358, 1872, 53, 104, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21477, 417, 102, 1, 33, "Subsection"],
Cell[21582, 420, 6356, 111, 218, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27975, 536, 144, 3, 33, "Subsection"],
Cell[CellGroupData[{
Cell[28144, 543, 5934, 96, 196, "Input"],
Cell[34081, 641, 11159, 317, 155, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[45301, 965, 108, 1, 83, "Section"],
Cell[CellGroupData[{
Cell[45434, 970, 161, 2, 33, "Subsection"],
Cell[CellGroupData[{
Cell[45620, 976, 9256, 173, 592, "Input"],
Cell[54879, 1151, 50939, 1460, 395, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[105867, 2617, 240, 4, 59, "Subsection"],
Cell[CellGroupData[{
Cell[106132, 2625, 5046, 69, 41, "Input"],
Cell[111181, 2696, 451, 10, 41, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[111681, 2712, 141, 2, 33, "Subsection"],
Cell[CellGroupData[{
Cell[111847, 2718, 5039, 72, 64, "Input"],
Cell[116889, 2792, 17327, 503, 344, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[134277, 3302, 95, 1, 83, "Section"],
Cell[CellGroupData[{
Cell[134397, 3307, 118, 1, 33, "Subsection"],
Cell[CellGroupData[{
Cell[134540, 3312, 7048, 124, 284, "Input"],
Cell[141591, 3438, 62599, 1704, 594, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[204251, 5149, 101, 1, 83, "Section"],
Cell[CellGroupData[{
Cell[204377, 5154, 114, 1, 33, "Subsection"],
Cell[204494, 5157, 3181, 78, 416, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[207712, 5240, 129, 3, 33, "Subsection"],
Cell[207844, 5245, 3126, 69, 306, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[211007, 5319, 127, 3, 33, "Subsection"],
Cell[211137, 5324, 2747, 62, 262, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[213921, 5391, 127, 3, 33, "Subsection"],
Cell[214051, 5396, 2347, 54, 240, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[216435, 5455, 137, 3, 33, "Subsection"],
Cell[CellGroupData[{
Cell[216597, 5462, 2904, 70, 328, "Input"],
Cell[219504, 5534, 6812, 185, 217, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[226377, 5726, 146, 3, 83, "Section"],
Cell[226526, 5731, 1284, 32, 108, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227847, 5768, 139, 3, 83, "Section"],
Cell[CellGroupData[{
Cell[228011, 5775, 7196, 156, 636, "Input"],
Cell[235210, 5933, 181, 2, 41, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[235440, 5941, 123, 3, 83, "Section"],
Cell[CellGroupData[{
Cell[235588, 5948, 6197, 139, 570, "Input"],
Cell[241788, 6089, 247, 3, 98, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
